<!DOCTYPE html>
<html lang="zh" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ğŸ“ æ’ä»¶å¼€å‘æŒ‡å— | Openai Kira Org</title>
    <meta name="description" content="Kira Kira Openaibot.">
    <link rel="preload stylesheet" href="/Docs/assets/style.6d7e1bc8.css" as="style">
    
    <script type="module" src="/Docs/assets/app.4ea8fc61.js"></script>
    <link rel="preload" href="/Docs/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Docs/assets/chunks/framework.b81f03d3.js">
    <link rel="modulepreload" href="/Docs/assets/chunks/theme.3b067f5e.js">
    <link rel="modulepreload" href="/Docs/assets/dev_basic.md.50613b2e.lean.js">
    <meta name="theme-color" content="#3c8772">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5a346dfe><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5a346dfe data-v-ae24b3ad><div class="VPNavBar has-sidebar" data-v-ae24b3ad data-v-a0fd61f4><div class="container" data-v-a0fd61f4><div class="title" data-v-a0fd61f4><div class="VPNavBarTitle has-sidebar" data-v-a0fd61f4 data-v-86d1bed8><a class="title" href="/Docs/" data-v-86d1bed8><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://avatars.githubusercontent.com/u/124290462?s=200&amp;v=4" alt data-v-8426fc1a><!--]--><!--[-->LLMKira<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-a0fd61f4><div class="curtain" data-v-a0fd61f4></div><div class="content-body" data-v-a0fd61f4><!--[--><!--]--><div class="VPNavBarSearch search" data-v-a0fd61f4><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a0fd61f4 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/Docs/guide/getting-started" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>Deploy Guide</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/Docs/dev/basic" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>Dev Tutorials</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-9c007e85><span class="text" data-v-9c007e85><!----><span data-v-9c007e85>About Repo</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://github.com/LLMKira/Openaibot/pulls?q=" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->Changelog<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-a0fd61f4 data-v-74abcbb9 data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-9c007e85><span class="text" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="option-icon" data-v-9c007e85><path d="M0 0h24v24H0z" fill="none"></path><path d=" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z " class="css-c4d79v"></path></svg><!----><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-9c007e85><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><div class="items" data-v-74abcbb9><p class="title" data-v-74abcbb9>Chinese</p><!--[--><div class="VPMenuLink" data-v-74abcbb9 data-v-43f1e123><a class="VPLink link" href="/Docs/en/dev/basic" data-v-43f1e123><!--[-->English<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-a0fd61f4 data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-e6aabb21 data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a0fd61f4 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LLMKira/Openaibot" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a0fd61f4 data-v-d0bd9dde data-v-9c007e85><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-9c007e85><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-9c007e85><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-9c007e85><div class="VPMenu" data-v-9c007e85 data-v-e7ea1737><!----><!--[--><!--[--><div class="group translations" data-v-d0bd9dde><p class="trans-title" data-v-d0bd9dde>Chinese</p><!--[--><div class="VPMenuLink" data-v-d0bd9dde data-v-43f1e123><a class="VPLink link" href="/Docs/en/dev/basic" data-v-43f1e123><!--[-->English<!--]--></a></div><!--]--></div><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-d0bd9dde data-v-ce54a7d1 data-v-b1685198><span class="check" data-v-b1685198><span class="icon" data-v-b1685198><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-ce54a7d1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-ce54a7d1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LLMKira/Openaibot" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-f80f8133><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a0fd61f4 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-5a346dfe data-v-79c8c1df><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-79c8c1df><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-79c8c1df><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-79c8c1df>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-79c8c1df data-v-1c15a60a><button data-v-1c15a60a>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-5a346dfe data-v-b00e2fdd><div class="curtain" data-v-b00e2fdd></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-b00e2fdd><span class="visually-hidden" id="sidebar-aria-label" data-v-b00e2fdd> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0 has-active" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>æ’ä»¶å¼€å‘æŒ‡å—</h2><!----></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/Docs/dev/basic" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>å¿«é€Ÿå¼€å‘</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/Docs/dev/middleware" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>ä¸­é—´ä»¶ä½¿ç”¨</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-b00e2fdd><section class="VPSidebarItem level-0" data-v-b00e2fdd data-v-e31bd47b><div class="item" role="button" tabindex="0" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><h2 class="text" data-v-e31bd47b>å¹³å°å¼€å‘æŒ‡å—</h2><!----></div><div class="items" data-v-e31bd47b><!--[--><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/Docs/dev/arch" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>æ¶æ„ä»‹ç»</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-e31bd47b data-v-e31bd47b><div class="item" data-v-e31bd47b><div class="indicator" data-v-e31bd47b></div><a class="VPLink link link" href="/Docs/dev/client" data-v-e31bd47b><!--[--><p class="text" data-v-e31bd47b>æ”¶å‘ç«¯</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5a346dfe data-v-669faec9><div class="VPDoc has-sidebar has-aside" data-v-669faec9 data-v-6b87e69f><!--[--><!--]--><div class="container" data-v-6b87e69f><div class="aside" data-v-6b87e69f><div class="aside-curtain" data-v-6b87e69f></div><div class="aside-container" data-v-6b87e69f><div class="aside-content" data-v-6b87e69f><div class="VPDocAside" data-v-6b87e69f data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-d330b1bb><div class="content" data-v-d330b1bb><div class="outline-marker" data-v-d330b1bb></div><div class="outline-title" role="heading" aria-level="2" data-v-d330b1bb>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-d330b1bb><span class="visually-hidden" id="doc-outline-aria-label" data-v-d330b1bb> Table of Contents for current page </span><ul class="root" data-v-d330b1bb data-v-d0ee3533><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-6b87e69f><div class="content-container" data-v-6b87e69f><!--[--><!--]--><!----><main class="main" data-v-6b87e69f><div style="position:relative;" class="vp-doc _Docs_dev_basic" data-v-6b87e69f><div><h1 id="ğŸ“-æ’ä»¶å¼€å‘æŒ‡å—" tabindex="-1">ğŸ“ æ’ä»¶å¼€å‘æŒ‡å— <a class="header-anchor" href="#ğŸ“-æ’ä»¶å¼€å‘æŒ‡å—" aria-label="Permalink to &quot;ğŸ“ æ’ä»¶å¼€å‘æŒ‡å—&quot;">â€‹</a></h1><blockquote><p>æ­¤è¿‡ç¨‹å¯èƒ½ä¼šè¿‡æ—¶ï¼Œæ¨èç›´æ¥ä»æ¨¡æ¿åº“å¼€å§‹å¼€å‘ã€‚ä¹Ÿå¯ä»¥å‚è€ƒå†…éƒ¨æ’ä»¶ <code>llmkira/extra/</code>ã€‚</p></blockquote><p>æœ¬æ–‡æ‰€ç”¨ç¤ºä¾‹æ’ä»¶æ¨¡æ¿åº“: <a href="https://github.com/LlmKira/llmbot_plugin_bilisearch" target="_blank" rel="noreferrer">https://github.com/LlmKira/llmbot_plugin_bilisearch</a></p><p>OpenaiBot ä¸ºç¬¬ä¸‰æ–¹æ’ä»¶æä¾›äº† OPENAPI æ¥å£æ³¨å†Œç³»ç»Ÿï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•å»ºé€ ä¸€ä¸ªæ’ä»¶ã€‚</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>å› ä¸ºæ’ä»¶æœºåˆ¶æ˜¯å‚è€ƒ <code>Nonebot</code> å®ç°ï¼Œæ•…æ’ä»¶å¼€å‘å’Œ NoneBot Plugin è¿‘ä¼¼ã€‚</p></div><h2 id="ğŸ“Œ-ç»“æ„è§„èŒƒ" tabindex="-1">ğŸ“Œ ç»“æ„è§„èŒƒ <a class="header-anchor" href="#ğŸ“Œ-ç»“æ„è§„èŒƒ" aria-label="Permalink to &quot;ğŸ“Œ ç»“æ„è§„èŒƒ&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">åŸºç¡€ç»“æ„ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#e1e4e8;">â”œâ”€â”€ LICENSE</span></span>
<span class="line"><span style="color:#e1e4e8;">â”œâ”€â”€ llmbot_plugin_bilisearch</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚       â””â”€ __init__.py</span></span>
<span class="line"><span style="color:#e1e4e8;">â”œâ”€â”€ poetry.lock</span></span>
<span class="line"><span style="color:#e1e4e8;">â”œâ”€â”€ pyproject.toml</span></span>
<span class="line"><span style="color:#e1e4e8;">â””â”€â”€ README.md</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">åŸºç¡€ç»“æ„ç¤ºä¾‹</span></span>
<span class="line"><span style="color:#24292e;">â”œâ”€â”€ LICENSE</span></span>
<span class="line"><span style="color:#24292e;">â”œâ”€â”€ llmbot_plugin_bilisearch</span></span>
<span class="line"><span style="color:#24292e;">â”‚       â””â”€ __init__.py</span></span>
<span class="line"><span style="color:#24292e;">â”œâ”€â”€ poetry.lock</span></span>
<span class="line"><span style="color:#24292e;">â”œâ”€â”€ pyproject.toml</span></span>
<span class="line"><span style="color:#24292e;">â””â”€â”€ README.md</span></span></code></pre></div><p><code>README.md</code> æ˜¯é¡¹ç›®çš„è¯´æ˜æ–‡ä»¶ã€‚</p><p><code>pyproject.toml</code> æ˜¯é¡¹ç›®çš„åŒ…ä¿¡æ¯æ–‡ä»¶ï¼ŒåŒ…å«åŒ…çš„åç§°ï¼Œä¾èµ–,å’Œä½œè€…ï¼Œä¸»é¡µç­‰é…ç½®ã€‚æŸ¥çœ‹<a href="https://python-poetry.org/docs/pyproject/" target="_blank" rel="noreferrer">è¯¦ç»†é€‰é¡¹</a>ã€‚</p><p><code>poetry.lock</code> æ˜¯é¡¹ç›®ä¾èµ–é”æ–‡ä»¶ï¼Œé”å®šä»“åº“ä¾èµ–ç‰ˆæœ¬ï¼Œè®©æ‰€æœ‰åä½œè€…éƒ½ä½¿ç”¨ç»Ÿä¸€ç‰ˆæœ¬ä¾èµ–ã€‚æ­¤æ–‡ä»¶åœ¨æ›´æ–°ä¾èµ–ç‰ˆæœ¬æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨ <code>poetry lock</code> å‘½ä»¤æ›´æ–°ã€‚</p><p><code>llmbot_plugin_bilisearch</code> æ˜¯ç¤ºä¾‹ä¸­æ’ä»¶çš„ä¸»ä½“ï¼Œå†…å«æ’ä»¶çš„çœŸæ­£æ‰§è¡Œæ–‡ä»¶å’Œèµ„æºã€‚</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>å› ä¸º pypi ä¸å…è®¸ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œæ•…æ’ä»¶æ‰“åŒ…æ–‡ä»¶å¤¹ä¸åº”ä¸Šä¼ è¾ƒå¤§èµ„æºæ–‡ä»¶ã€‚</p></div><p><code>LICENSE</code> æ˜¯é¡¹ç›®çš„å¼€æºåè®®æ–‡ä»¶ï¼Œå…·æœ‰ä¸€å®šæ³•å¾‹æ•ˆåŠ›ã€‚é€‰æ‹©åè®®å¯ä»¥å‚è€ƒ <a href="https://www.zhihu.com/question/19568896" target="_blank" rel="noreferrer">çŸ¥ä¹é—®é¢˜</a>ã€‚</p><h3 id="ğŸ”—-å¯¼å…¥éªŒè¯" tabindex="-1">ğŸ”— å¯¼å…¥éªŒè¯ <a class="header-anchor" href="#ğŸ”—-å¯¼å…¥éªŒè¯" aria-label="Permalink to &quot;ğŸ”— å¯¼å…¥éªŒè¯&quot;">â€‹</a></h3><p>é¦–å…ˆç¡®è®¤æ‚¨å®‰è£…äº†ä¸€ä¸ªä»£ç ç¼–è¾‘å™¨ï¼ŒPython ç¯å¢ƒ(ç‰ˆæœ¬å¤§äº3.9)ã€‚åœ¨ Shellæ§åˆ¶å° æˆ– CMDå‘½ä»¤è¡Œ è¾“å…¥ <code>python -v</code> æ£€æŸ¥æˆ–æŸ¥çœ‹ç‰ˆæœ¬ã€‚</p><h4 id="ä¸‹è½½æ‰€éœ€çš„å·¥å…·" tabindex="-1">ä¸‹è½½æ‰€éœ€çš„å·¥å…· <a class="header-anchor" href="#ä¸‹è½½æ‰€éœ€çš„å·¥å…·" aria-label="Permalink to &quot;ä¸‹è½½æ‰€éœ€çš„å·¥å…·&quot;">â€‹</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">pip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">llmkira</span></span>
<span class="line"><span style="color:#B392F0;">pip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">poetry</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">pip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">llmkira</span></span>
<span class="line"><span style="color:#6F42C1;">pip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">poetry</span></span></code></pre></div><p><code>llmkira</code> æ˜¯æœºå™¨äººä¸»ä½“æ–‡ä»¶çš„æ‰“åŒ…é›†åˆï¼Œæ’ä»¶éœ€è¦å¯¼å…¥å…¶ä¸­çš„ç±»è¿›è¡Œä½¿ç”¨ã€‚è¿™é‡Œæœ‰å¯¼å…¥çš„<a href="https://github.com/LlmKira/llmbot_plugin_bilisearch/blob/main/llmbot_plugin_bilisearch/__init__.py" target="_blank" rel="noreferrer">ç¤ºä¾‹</a>ã€‚</p><p><code>poetry</code> æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„ä¾èµ–ç®¡ç†å’Œæ‰“åŒ…çš„å·¥å…·ã€‚<a href="https://python-poetry.org/docs/basic-usage/" target="_blank" rel="noreferrer">åŸºç¡€å‘½ä»¤ä»‹ç»</a>ã€‚</p><div class="info custom-block"><p class="custom-block-title">å¸¸ç”¨å‘½ä»¤</p><ul><li><code>poetry init</code> åˆ›å»ºä¸€ä¸ª <code>pyproject.toml</code> æ–‡ä»¶</li><li><code>poetry lock</code> æ›´æ–°ä¾èµ–é”</li><li><code>poetry add &lt;name&gt;</code> æ·»åŠ ä¾èµ–</li><li><code>poetry install</code> å®‰è£…å½“å‰åº“åˆ°æœ¬åœ°ç¯å¢ƒ</li><li><code>poetry build</code> æ„å»ºåº“</li><li><code>poetry publish</code> å‘å¸ƒåº“</li></ul></div><p>åœ¨ Github æ–°å»ºé¡¹ç›®å¹¶æ‹‰å–æœ¬åœ°ã€‚</p><p>ç”¨ä»£ç ç¼–è¾‘å™¨æ‰“å¼€æœ¬åœ°é¡¹ç›®æ–‡ä»¶å¤¹ï¼Œå†å»ºç«‹æ’ä»¶æ–‡ä»¶å¤¹ï¼Œåœ¨å½“å‰é¡¹ç›®ä½ç½®æ‰“å¼€ Shell è¾“å…¥ <code>poetry init</code> å»ºç«‹åŸºç¡€åŒ…ç»“æ„ã€‚</p><p>è¾“å…¥æ‰€éœ€ä¿¡æ¯å®Œå–„ <code>pyproject.toml</code> æ–‡ä»¶ã€‚</p><p>ä½¿ç”¨ <code>poetry add &lt;some&gt;</code> å‘½ä»¤æˆ–è€…ç¼–è¾‘é…ç½®æ–‡ä»¶æ·»åŠ ä¾èµ–ã€‚</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#B392F0;">tool</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">poetry</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">dependencies</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">python = </span><span style="color:#9ECBFF;">&quot;^3.9&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">bilibili-api-python = </span><span style="color:#9ECBFF;">&quot;^16.1.0&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#6F42C1;">tool</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">poetry</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">dependencies</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">python = </span><span style="color:#032F62;">&quot;^3.9&quot;</span></span>
<span class="line"><span style="color:#24292E;">bilibili-api-python = </span><span style="color:#032F62;">&quot;^16.1.0&quot;</span></span></code></pre></div><p>è‡³æ­¤ï¼Œé¡¹ç›®åŸºæœ¬ç»“æ„å·²ç»å»ºç«‹ã€‚</p><h2 id="ğŸ“¦-å¼€å‘æµç¨‹" tabindex="-1">ğŸ“¦ å¼€å‘æµç¨‹ <a class="header-anchor" href="#ğŸ“¦-å¼€å‘æµç¨‹" aria-label="Permalink to &quot;ğŸ“¦ å¼€å‘æµç¨‹&quot;">â€‹</a></h2><p>æ’ä»¶å†…éƒ¨ç”± å‡½æ•°ç±»ï¼Œå·¥å…·ç±»ï¼Œå…ƒä¿¡æ¯ï¼ŒåŠŸèƒ½å‡½æ•°ï¼Œå‚æ•°æ ¡éªŒç±» ç»„æˆã€‚</p><p>å‡½æ•°å†…æ’ä»¶åç§°<strong>å¿…é¡»</strong>ç”± <code>__plugin_name__</code> å‚æ•°å¼•ç”¨ã€‚</p><h3 id="ğŸ”§-æµ‹è¯•ç¯å¢ƒ" tabindex="-1">ğŸ”§ æµ‹è¯•ç¯å¢ƒ <a class="header-anchor" href="#ğŸ”§-æµ‹è¯•ç¯å¢ƒ" aria-label="Permalink to &quot;ğŸ”§ æµ‹è¯•ç¯å¢ƒ&quot;">â€‹</a></h3><p>æ‚¨å¯ä»¥å°†æ’ä»¶æ”¾å…¥é¡¹ç›®ä¸‹ <code>Openaibot/llmkira/extra/plugins</code> æ¥æœ¬åœ°æŒ‚è½½æµ‹è¯•ã€‚</p><p>æˆ–ä½¿ç”¨ poetry æœ¬åœ°å®‰è£…æŒ‚è½½ã€‚</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">your_plugin_path</span></span>
<span class="line"><span style="color:#B392F0;">poetry</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">your_plugin_path</span></span>
<span class="line"><span style="color:#6F42C1;">poetry</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span></span></code></pre></div><h3 id="ğŸª£-æ·»åŠ å˜é‡ä¸éªŒè¯" tabindex="-1">ğŸª£ æ·»åŠ å˜é‡ä¸éªŒè¯ <a class="header-anchor" href="#ğŸª£-æ·»åŠ å˜é‡ä¸éªŒè¯" aria-label="Permalink to &quot;ğŸª£ æ·»åŠ å˜é‡ä¸éªŒè¯&quot;">â€‹</a></h3><p><strong>ä¸‹é¢çš„ä»£ç å¿…é¡»æ”¾è¿›å¼€å¤´è¿›è¡Œæ¶æ„ç‰ˆæœ¬éªŒè¯ã€‚</strong></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark has-highlighted-lines vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">__package_name__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;llmbot_plugin_bilisearch&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">__plugin_name__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">__openapi_version__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># refer https://github.com/LlmKira/Openaibot/blob/main/llmkira/sdk/func_calling/__init__.py#L27</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> llmkira.sdk.func_calling </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> verify_openapi_version</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#E1E4E8;">verify_openapi_version(__package_name__, __openapi_version__)  </span><span style="color:#6A737D;"># éªŒè¯ </span></span></code></pre><pre class="shiki github-light has-highlighted-lines vp-code-light"><code><span class="line"><span style="color:#24292E;">__package_name__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;llmbot_plugin_bilisearch&quot;</span></span>
<span class="line"><span style="color:#24292E;">__plugin_name__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"><span style="color:#24292E;">__openapi_version__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># refer https://github.com/LlmKira/Openaibot/blob/main/llmkira/sdk/func_calling/__init__.py#L27</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> llmkira.sdk.func_calling </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> verify_openapi_version</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="color:#24292E;">verify_openapi_version(__package_name__, __openapi_version__)  </span><span style="color:#6A737D;"># éªŒè¯ </span></span></code></pre></div><h3 id="âš™ï¸-å®šä¹‰å‡½æ•°ç±»" tabindex="-1">âš™ï¸ å®šä¹‰å‡½æ•°ç±» <a class="header-anchor" href="#âš™ï¸-å®šä¹‰å‡½æ•°ç±»" aria-label="Permalink to &quot;âš™ï¸ å®šä¹‰å‡½æ•°ç±»&quot;">â€‹</a></h3><h4 id="ğŸ§©-ä»-pydantic-2-0-æ¨¡å‹åˆ›å»ºå‡½æ•°ç±»" tabindex="-1">ğŸ§© ä» pydantic 2.0 æ¨¡å‹åˆ›å»ºå‡½æ•°ç±» <a class="header-anchor" href="#ğŸ§©-ä»-pydantic-2-0-æ¨¡å‹åˆ›å»ºå‡½æ•°ç±»" aria-label="Permalink to &quot;ğŸ§© ä» pydantic 2.0 æ¨¡å‹åˆ›å»ºå‡½æ•°ç±»&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> llmkira.sdk.schema </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Function</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> pydantic </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> BaseModel, ConfigDict, field_validator, Field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">__plugin_name__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># function verification class</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Alarm</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">BaseModel</span><span style="color:#E1E4E8;">):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">    Set a timed reminder (only for minutes)</span></span>
<span class="line"><span style="color:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    delay: </span><span style="color:#79B8FF;">int</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;The delay time, in minutes&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    content: </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;reminder content&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    model_config </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ConfigDict(</span><span style="color:#FFAB70;">extra</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;allow&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">@field_validator</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;delay&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">delay_validator</span><span style="color:#E1E4E8;">(cls, v):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> v </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">raise</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ValueError</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;delay must be greater than 0&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> v</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">function </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Function.parse_from_pydantic(</span><span style="color:#FFAB70;">schema_model</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">Alarm, </span><span style="color:#FFAB70;">plugin_name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">__plugin_name__)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Function(name=&#39;Alarm&#39;, description=&#39;Set a timed reminder (only for minutes)&#39;, parameters=Parameters(type=&#39;object&#39;, properties={&#39;delay&#39;: {&#39;description&#39;: &#39;The delay time, in minutes&#39;, &#39;title&#39;: &#39;Delay&#39;, &#39;type&#39;: &#39;integer&#39;}, &#39;content&#39;: {&#39;description&#39;: &#39;reminder content&#39;, &#39;title&#39;: &#39;Content&#39;, &#39;type&#39;: &#39;string&#39;}}, required=[&#39;content&#39;, &#39;delay&#39;]))</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> llmkira.sdk.schema </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Function</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> pydantic </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> BaseModel, ConfigDict, field_validator, Field</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">__plugin_name__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># function verification class</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Alarm</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">BaseModel</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">    Set a timed reminder (only for minutes)</span></span>
<span class="line"><span style="color:#032F62;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    delay: </span><span style="color:#005CC5;">int</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;The delay time, in minutes&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    content: </span><span style="color:#005CC5;">str</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;reminder content&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    model_config </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ConfigDict(</span><span style="color:#E36209;">extra</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;allow&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">@field_validator</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;delay&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">delay_validator</span><span style="color:#24292E;">(cls, v):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> v </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">raise</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ValueError</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;delay must be greater than 0&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> v</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">function </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Function.parse_from_pydantic(</span><span style="color:#E36209;">schema_model</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">Alarm, </span><span style="color:#E36209;">plugin_name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">__plugin_name__)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Function(name=&#39;Alarm&#39;, description=&#39;Set a timed reminder (only for minutes)&#39;, parameters=Parameters(type=&#39;object&#39;, properties={&#39;delay&#39;: {&#39;description&#39;: &#39;The delay time, in minutes&#39;, &#39;title&#39;: &#39;Delay&#39;, &#39;type&#39;: &#39;integer&#39;}, &#39;content&#39;: {&#39;description&#39;: &#39;reminder content&#39;, &#39;title&#39;: &#39;Content&#39;, &#39;type&#39;: &#39;string&#39;}}, required=[&#39;content&#39;, &#39;delay&#39;]))</span></span></code></pre></div><h4 id="ğŸ§²-å•ç‹¬åˆ›å»ºå‡½æ•°ç±»" tabindex="-1">ğŸ§² å•ç‹¬åˆ›å»ºå‡½æ•°ç±» <a class="header-anchor" href="#ğŸ§²-å•ç‹¬åˆ›å»ºå‡½æ•°ç±»" aria-label="Permalink to &quot;ğŸ§² å•ç‹¬åˆ›å»ºå‡½æ•°ç±»&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">__plugin_name__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> llmkira.sdk.endpoint.openai </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Function</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">bilibili </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Function(</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">__plugin_name__,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;Search videos on bilibili.com(å“”å“©å“”å“©)&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">).update_config(</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">config</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">Function.FunctionExtra(</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">system_prompt</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;ğŸ”Searching on google.com...&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">bilibili.add_property(</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">property_name</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;keywords&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">property_description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;Keywords entered in the search box&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">property_type</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;string&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">required</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">True</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">__plugin_name__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> llmkira.sdk.endpoint.openai </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Function</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">bilibili </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Function(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">__plugin_name__,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Search videos on bilibili.com(å“”å“©å“”å“©)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">).update_config(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">config</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">Function.FunctionExtra(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">system_prompt</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;ğŸ”Searching on google.com...&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">bilibili.add_property(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">property_name</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;keywords&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">property_description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Keywords entered in the search box&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">property_type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;string&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">required</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span></span>
<span class="line"><span style="color:#24292E;">)</span></span></code></pre></div><p>è¿™é‡Œçš„ä¿¡æ¯ä¼šè¢«æäº¤ç»™LLMä½¿ç”¨ï¼Œä½ å¯ä»¥è¿ç”¨ <code>Prompt å·¥ç¨‹</code> æ¥æ”¹è¿›ä»–ä»¬ã€‚</p><p><code>required</code> å±æ€§ä¸ä¸€å®šæœ‰æ•ˆã€‚</p><h3 id="ğŸ©¼-æ·»åŠ å‡½æ•°æ ¡éªŒç±»" tabindex="-1">ğŸ©¼ æ·»åŠ å‡½æ•°æ ¡éªŒç±» <a class="header-anchor" href="#ğŸ©¼-æ·»åŠ å‡½æ•°æ ¡éªŒç±»" aria-label="Permalink to &quot;ğŸ©¼ æ·»åŠ å‡½æ•°æ ¡éªŒç±»&quot;">â€‹</a></h3><p>åœ¨å®é™…æƒ…å†µä¸­ï¼Œå³ä½¿æ‚¨çš„å‡½æ•°å®šä¹‰äº†å‚æ•° required=Trueï¼Œä½†æ˜¯è¿”å›ä¹Ÿå¯èƒ½æ˜¯ Noneï¼Œæ•…æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå‚æ•°æ ¡éªŒç±»æ¥æ£€æŸ¥å‚æ•°ã€‚</p><p>å€ŸåŠ©äº <a href="https://pydantic-docs.helpmanual.io/" target="_blank" rel="noreferrer">pydantic</a> ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„å®ç°å‚æ•°æ ¡éªŒã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark has-focused-lines vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> pydantic </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> BaseModel, ConfigDict</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Bili</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">BaseModel</span><span style="color:#E1E4E8;">):  </span><span style="color:#6A737D;"># å‚æ•° </span></span>
<span class="line has-focus"></span>
<span class="line has-focus"><span style="color:#E1E4E8;">    keywords: </span><span style="color:#79B8FF;">str</span></span>
<span class="line has-focus"></span>
<span class="line has-focus"><span style="color:#E1E4E8;">    model_config </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ConfigDict(</span><span style="color:#FFAB70;">extra</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;allow&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">try</span><span style="color:#E1E4E8;">:</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">    _set </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Bili.model_validate({</span><span style="color:#9ECBFF;">&quot;arg&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">})  </span><span style="color:#6A737D;"># </span></span>
<span class="line has-focus"><span style="color:#F97583;">except</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Exception</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">as</span><span style="color:#E1E4E8;"> e:</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(e)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># failed</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pass</span></span></code></pre><pre class="shiki github-light has-focused-lines vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> pydantic </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> BaseModel, ConfigDict</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Bili</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">BaseModel</span><span style="color:#24292E;">):  </span><span style="color:#6A737D;"># å‚æ•° </span></span>
<span class="line has-focus"></span>
<span class="line has-focus"><span style="color:#24292E;">    keywords: </span><span style="color:#005CC5;">str</span></span>
<span class="line has-focus"></span>
<span class="line has-focus"><span style="color:#24292E;">    model_config </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ConfigDict(</span><span style="color:#E36209;">extra</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;allow&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">try</span><span style="color:#24292E;">:</span></span>
<span class="line has-focus"><span style="color:#24292E;">    _set </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Bili.model_validate({</span><span style="color:#032F62;">&quot;arg&quot;</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">...</span><span style="color:#24292E;">})  </span><span style="color:#6A737D;"># </span></span>
<span class="line has-focus"><span style="color:#D73A49;">except</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Exception</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> e:</span></span>
<span class="line has-focus"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(e)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># failed</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pass</span></span></code></pre></div><p>è¯·æ‚¨åœ¨ å·¥å…·ç±» çš„ <code>run</code> æ–¹æ³•ä¸­ä½¿ç”¨ pydantic åšå‚æ•°æ ¡éªŒã€‚</p><h3 id="âš“ï¸-åŠŸèƒ½å‡½æ•°" tabindex="-1">âš“ï¸ åŠŸèƒ½å‡½æ•° <a class="header-anchor" href="#âš“ï¸-åŠŸèƒ½å‡½æ•°" aria-label="Permalink to &quot;âš“ï¸ åŠŸèƒ½å‡½æ•°&quot;">â€‹</a></h3><p>åŠŸèƒ½å‡½æ•°å°±æ˜¯ä¸€ä¸ªå®ç°åŠŸèƒ½çš„å‡½æ•°ã€‚éšä¾¿ä½ æ€ä¹ˆå†™ã€‚</p><p>æ­¤å‡½æ•°è‡ªç”±å‘æŒ¥ï¼Œä½†æ˜¯ä¹‹åçš„OPENAPIæ¶æ„éœ€è¦åŒ¹é…ä¸€ä¸ªé”™è¯¯è£…é¥°å™¨æ¥è®¡æ•°é”™è¯¯ã€‚</p><p>æ•…æ¨èç¼–å†™ä¸€ä¸ªä¸»å‡½æ•°ä¾¿äºåç»­å‡çº§ã€‚</p><h3 id="ğŸ­-å·¥å…·ç±»" tabindex="-1">ğŸ­ å·¥å…·ç±» <a class="header-anchor" href="#ğŸ­-å·¥å…·ç±»" aria-label="Permalink to &quot;ğŸ­ å·¥å…·ç±»&quot;">â€‹</a></h3><p>æ‰€æœ‰å·¥å…·ç±»å¿…é¡»ç»§æ‰¿ <a href="https://github.com/LlmKira/Openaibot/blob/main/llmkira/sdk/func_calling/schema.py#L14" target="_blank" rel="noreferrer">BaseTool</a>ã€‚</p><p>å…·ä½“å†™æ³•è§ä¸‹ï¼š</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> os</span></span>
<span class="line"><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> re</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> abc </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> abstractmethod, </span><span style="color:#79B8FF;">ABC</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> typing </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> Optional, Dict, Any, List, Union, final, Literal</span></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> typing </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">TYPE_CHECKING</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> pydantic </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> BaseModel, Field, PrivateAttr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">TYPE_CHECKING</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pass</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">BaseTool</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">ABC</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">BaseModel</span><span style="color:#E1E4E8;">):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">    åŸºç¡€å·¥å…·ç±»ï¼Œæ‰€æœ‰å·¥å…·ç±»éƒ½åº”è¯¥ç»§æ‰¿æ­¤ç±»</span></span>
<span class="line"><span style="color:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">__slots__</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> ()</span></span>
<span class="line"><span style="color:#E1E4E8;">    silent: </span><span style="color:#79B8FF;">bool</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">False</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;æ˜¯å¦é™é»˜&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    function: </span><span style="color:#9ECBFF;">&quot;Function&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;åŠŸèƒ½&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    keywords: List[</span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field([], </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;å…³é”®è¯&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    pattern: Optional[re.Pattern] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">None</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;æ­£åˆ™åŒ¹é…&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    require_auth: </span><span style="color:#79B8FF;">bool</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">False</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;æ˜¯å¦éœ€è¦æˆæƒ&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    repeatable: </span><span style="color:#79B8FF;">bool</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">False</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;æ˜¯å¦å¯é‡å¤ä½¿ç”¨&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    deploy_child: Literal[</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;å¦‚æœä¸º0ï¼Œç»ˆç»“äºæ­¤é“¾ç‚¹ï¼Œä¸å†å‘ä¸‹ä¼ é€’&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    require_auth_kwargs: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> {}</span></span>
<span class="line"><span style="color:#E1E4E8;">    env_required: List[</span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field([], </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;ç¯å¢ƒå˜é‡è¦æ±‚,ALSO NEED env_prefix&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    env_prefix: </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;ç¯å¢ƒå˜é‡å‰ç¼€&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    file_match_required: Optional[re.Pattern] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field(</span><span style="color:#79B8FF;">None</span><span style="color:#E1E4E8;">, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;re.compile æ–‡ä»¶åæ­£åˆ™&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    extra_arg: Dict[Any, Any] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> Field({}, </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;é¢å¤–å‚æ•°&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    __run_arg: Dict[Any, Any] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> PrivateAttr(</span><span style="color:#FFAB70;">default_factory</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># exp: re.compile(r&quot;file_id=([a-z0-9]{8})&quot;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">@final</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">get_os_env</span><span style="color:#E1E4E8;">(self, env_name):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        è·å– PLUGIN_+ å…¬å…±ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        env </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> os.getenv(</span><span style="color:#9ECBFF;">&quot;PLUGIN_&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> env_name, </span><span style="color:#79B8FF;">None</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> env</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">env_help_docs</span><span style="color:#E1E4E8;">(self, empty_env: List[</span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">]) -&gt; </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        ç¯å¢ƒå˜é‡å¸®åŠ©æ–‡æ¡£</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param empty_env: æœªè¢«é…ç½®çš„ç¯å¢ƒå˜é‡åˆ—è¡¨</span></span>
<span class="line"><span style="color:#9ECBFF;">        :return: å¸®åŠ©æ–‡æ¡£/è­¦å‘Š</span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">assert</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">isinstance</span><span style="color:#E1E4E8;">(empty_env, </span><span style="color:#79B8FF;">list</span><span style="color:#E1E4E8;">), </span><span style="color:#9ECBFF;">&quot;empty_env must be list&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;You need to configure ENV to start use this tool&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">@abstractmethod</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">pre_check</span><span style="color:#E1E4E8;">(self) -&gt; Union[</span><span style="color:#79B8FF;">bool</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">str</span><span style="color:#E1E4E8;">]:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        é¢„æ£€æŸ¥ï¼Œå¦‚æœä¸åˆæ ¼åˆ™è¿”å› Falseï¼Œåˆæ ¼åˆ™è¿”å› True</span></span>
<span class="line"><span style="color:#9ECBFF;">        è¿”å›å­—ç¬¦ä¸²è¡¨ç¤ºä¸åˆæ ¼ï¼Œä¸”æœ‰åŸå› </span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">@abstractmethod</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">func_message</span><span style="color:#E1E4E8;">(self, message_text, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">kwargs):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        å¦‚æœåˆæ ¼åˆ™è¿”å›messageï¼Œå¦åˆ™è¿”å›Noneï¼Œè¡¨ç¤ºä¸å¤„ç†</span></span>
<span class="line"><span style="color:#9ECBFF;">        å†³å®šäº†æ­¤å‡½æ•°æ˜¯å¦è¢«æ·»åŠ è¿›å¤‡é€‰ä¸­ã€‚å¯ä»¥è‡ªç”±å®šåˆ¶</span></span>
<span class="line"><span style="color:#9ECBFF;">        message_text: æ¶ˆæ¯æ–‡æœ¬</span></span>
<span class="line"><span style="color:#9ECBFF;">        message_raw: æ¶ˆæ¯åŸå§‹æ•°æ® `RawMessage`</span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># message_raw=kwargs.get(&quot;message_raw&quot;) # è·å–åŸå§‹æ¶ˆæ¯è€Œä¸æ˜¯æ–‡æœ¬å†…å®¹</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.keywords:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> message_text:</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.function</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># æ­£åˆ™åŒ¹é…</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.pattern:</span></span>
<span class="line"><span style="color:#E1E4E8;">            match </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.pattern.match(message_text)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> match:</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">self</span><span style="color:#E1E4E8;">.function</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">@abstractmethod</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">failed</span><span style="color:#E1E4E8;">(self,</span></span>
<span class="line"><span style="color:#E1E4E8;">                     task: </span><span style="color:#9ECBFF;">&quot;TaskHeader&quot;</span><span style="color:#E1E4E8;">, receiver: </span><span style="color:#9ECBFF;">&quot;TaskHeader.Location&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                     exception, env: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                     arg: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">, pending_task: </span><span style="color:#9ECBFF;">&quot;TaskBatch&quot;</span><span style="color:#E1E4E8;">, refer_llm_result: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">None</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                     ):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        é€šå¸¸ä¸º å›å†™æ¶ˆæ¯+é€šçŸ¥æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param task: ä»»åŠ¡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param receiver: æ¥æ”¶è€…</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param exception: å¼‚å¸¸</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param env: ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param arg: å‚æ•°</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param pending_task: ä»»åŠ¡æ‰¹æ¬¡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param refer_llm_result: ä¸Šä¸€æ¬¡çš„ç»“æœ</span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">@abstractmethod</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">callback</span><span style="color:#E1E4E8;">(self,</span></span>
<span class="line"><span style="color:#E1E4E8;">                       task: </span><span style="color:#9ECBFF;">&quot;TaskHeader&quot;</span><span style="color:#E1E4E8;">, receiver: </span><span style="color:#9ECBFF;">&quot;TaskHeader.Location&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                       env: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                       arg: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">, pending_task: </span><span style="color:#9ECBFF;">&quot;TaskBatch&quot;</span><span style="color:#E1E4E8;">, refer_llm_result: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">None</span></span>
<span class="line"><span style="color:#E1E4E8;">                       ):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        è¿è¡ŒæˆåŠŸä¼šè°ƒç”¨æ­¤å‡½æ•°</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param task: ä»»åŠ¡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param receiver: æ¥æ”¶è€…</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param arg: å‚æ•°</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param env: ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param pending_task: ä»»åŠ¡æ‰¹æ¬¡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param refer_llm_result: ä¸Šä¸€æ¬¡çš„ç»“æœ</span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">@abstractmethod</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(self, </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                  task: </span><span style="color:#9ECBFF;">&quot;TaskHeader&quot;</span><span style="color:#E1E4E8;">, receiver: </span><span style="color:#9ECBFF;">&quot;TaskHeader.Location&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                  arg: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">, env: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">, pending_task: </span><span style="color:#9ECBFF;">&quot;TaskBatch&quot;</span><span style="color:#E1E4E8;">, refer_llm_result: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">None</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">                  ):</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">        å¤„ç†å‡½æ•°å¹¶è¿”å›å›å†™ç»“æœ</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param task: ä»»åŠ¡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param receiver: æ¥æ”¶è€…</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param arg: å‚æ•°</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param env: ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param pending_task: ä»»åŠ¡æ‰¹æ¬¡</span></span>
<span class="line"><span style="color:#9ECBFF;">        :param refer_llm_result: ä¸Šä¸€æ¬¡çš„ç»“æœ</span></span>
<span class="line"><span style="color:#9ECBFF;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> os</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> re</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> abc </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> abstractmethod, </span><span style="color:#005CC5;">ABC</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> typing </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> Optional, Dict, Any, List, Union, final, Literal</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> typing </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">TYPE_CHECKING</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> pydantic </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> BaseModel, Field, PrivateAttr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">TYPE_CHECKING</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pass</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">BaseTool</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">ABC</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">BaseModel</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">    åŸºç¡€å·¥å…·ç±»ï¼Œæ‰€æœ‰å·¥å…·ç±»éƒ½åº”è¯¥ç»§æ‰¿æ­¤ç±»</span></span>
<span class="line"><span style="color:#032F62;">    &quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">__slots__</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ()</span></span>
<span class="line"><span style="color:#24292E;">    silent: </span><span style="color:#005CC5;">bool</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;æ˜¯å¦é™é»˜&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    function: </span><span style="color:#032F62;">&quot;Function&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;åŠŸèƒ½&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    keywords: List[</span><span style="color:#005CC5;">str</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field([], </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;å…³é”®è¯&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    pattern: Optional[re.Pattern] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;æ­£åˆ™åŒ¹é…&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    require_auth: </span><span style="color:#005CC5;">bool</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;æ˜¯å¦éœ€è¦æˆæƒ&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    repeatable: </span><span style="color:#005CC5;">bool</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;æ˜¯å¦å¯é‡å¤ä½¿ç”¨&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    deploy_child: Literal[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;å¦‚æœä¸º0ï¼Œç»ˆç»“äºæ­¤é“¾ç‚¹ï¼Œä¸å†å‘ä¸‹ä¼ é€’&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    require_auth_kwargs: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> {}</span></span>
<span class="line"><span style="color:#24292E;">    env_required: List[</span><span style="color:#005CC5;">str</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field([], </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;ç¯å¢ƒå˜é‡è¦æ±‚,ALSO NEED env_prefix&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    env_prefix: </span><span style="color:#005CC5;">str</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;ç¯å¢ƒå˜é‡å‰ç¼€&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    file_match_required: Optional[re.Pattern] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field(</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;re.compile æ–‡ä»¶åæ­£åˆ™&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    extra_arg: Dict[Any, Any] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> Field({}, </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;é¢å¤–å‚æ•°&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    __run_arg: Dict[Any, Any] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> PrivateAttr(</span><span style="color:#E36209;">default_factory</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># exp: re.compile(r&quot;file_id=([a-z0-9]{8})&quot;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">@final</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">get_os_env</span><span style="color:#24292E;">(self, env_name):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">        è·å– PLUGIN_+ å…¬å…±ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#032F62;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        env </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> os.getenv(</span><span style="color:#032F62;">&quot;PLUGIN_&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> env_name, </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> env</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">env_help_docs</span><span style="color:#24292E;">(self, empty_env: List[</span><span style="color:#005CC5;">str</span><span style="color:#24292E;">]) -&gt; </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">        ç¯å¢ƒå˜é‡å¸®åŠ©æ–‡æ¡£</span></span>
<span class="line"><span style="color:#032F62;">        :param empty_env: æœªè¢«é…ç½®çš„ç¯å¢ƒå˜é‡åˆ—è¡¨</span></span>
<span class="line"><span style="color:#032F62;">        :return: å¸®åŠ©æ–‡æ¡£/è­¦å‘Š</span></span>
<span class="line"><span style="color:#032F62;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">assert</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">isinstance</span><span style="color:#24292E;">(empty_env, </span><span style="color:#005CC5;">list</span><span style="color:#24292E;">), </span><span style="color:#032F62;">&quot;empty_env must be list&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;You need to configure ENV to start use this tool&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">@abstractmethod</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">pre_check</span><span style="color:#24292E;">(self) -&gt; Union[</span><span style="color:#005CC5;">bool</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">str</span><span style="color:#24292E;">]:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">        é¢„æ£€æŸ¥ï¼Œå¦‚æœä¸åˆæ ¼åˆ™è¿”å› Falseï¼Œåˆæ ¼åˆ™è¿”å› True</span></span>
<span class="line"><span style="color:#032F62;">        è¿”å›å­—ç¬¦ä¸²è¡¨ç¤ºä¸åˆæ ¼ï¼Œä¸”æœ‰åŸå› </span></span>
<span class="line"><span style="color:#032F62;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">@abstractmethod</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">func_message</span><span style="color:#24292E;">(self, message_text, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">kwargs):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">        å¦‚æœåˆæ ¼åˆ™è¿”å›messageï¼Œå¦åˆ™è¿”å›Noneï¼Œè¡¨ç¤ºä¸å¤„ç†</span></span>
<span class="line"><span style="color:#032F62;">        å†³å®šäº†æ­¤å‡½æ•°æ˜¯å¦è¢«æ·»åŠ è¿›å¤‡é€‰ä¸­ã€‚å¯ä»¥è‡ªç”±å®šåˆ¶</span></span>
<span class="line"><span style="color:#032F62;">        message_text: æ¶ˆæ¯æ–‡æœ¬</span></span>
<span class="line"><span style="color:#032F62;">        message_raw: æ¶ˆæ¯åŸå§‹æ•°æ® `RawMessage`</span></span>
<span class="line"><span style="color:#032F62;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># message_raw=kwargs.get(&quot;message_raw&quot;) # è·å–åŸå§‹æ¶ˆæ¯è€Œä¸æ˜¯æ–‡æœ¬å†…å®¹</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.keywords:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> message_text:</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.function</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># æ­£åˆ™åŒ¹é…</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.pattern:</span></span>
<span class="line"><span style="color:#24292E;">            match </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.pattern.match(message_text)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> match:</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">self</span><span style="color:#24292E;">.function</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">@abstractmethod</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">failed</span><span style="color:#24292E;">(self,</span></span>
<span class="line"><span style="color:#24292E;">                     task: </span><span style="color:#032F62;">&quot;TaskHeader&quot;</span><span style="color:#24292E;">, receiver: </span><span style="color:#032F62;">&quot;TaskHeader.Location&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                     exception, env: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                     arg: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">, pending_task: </span><span style="color:#032F62;">&quot;TaskBatch&quot;</span><span style="color:#24292E;">, refer_llm_result: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                     ):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">        é€šå¸¸ä¸º å›å†™æ¶ˆæ¯+é€šçŸ¥æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#032F62;">        :param task: ä»»åŠ¡</span></span>
<span class="line"><span style="color:#032F62;">        :param receiver: æ¥æ”¶è€…</span></span>
<span class="line"><span style="color:#032F62;">        :param exception: å¼‚å¸¸</span></span>
<span class="line"><span style="color:#032F62;">        :param env: ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#032F62;">        :param arg: å‚æ•°</span></span>
<span class="line"><span style="color:#032F62;">        :param pending_task: ä»»åŠ¡æ‰¹æ¬¡</span></span>
<span class="line"><span style="color:#032F62;">        :param refer_llm_result: ä¸Šä¸€æ¬¡çš„ç»“æœ</span></span>
<span class="line"><span style="color:#032F62;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">@abstractmethod</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">callback</span><span style="color:#24292E;">(self,</span></span>
<span class="line"><span style="color:#24292E;">                       task: </span><span style="color:#032F62;">&quot;TaskHeader&quot;</span><span style="color:#24292E;">, receiver: </span><span style="color:#032F62;">&quot;TaskHeader.Location&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                       env: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                       arg: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">, pending_task: </span><span style="color:#032F62;">&quot;TaskBatch&quot;</span><span style="color:#24292E;">, refer_llm_result: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span></span>
<span class="line"><span style="color:#24292E;">                       ):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">        è¿è¡ŒæˆåŠŸä¼šè°ƒç”¨æ­¤å‡½æ•°</span></span>
<span class="line"><span style="color:#032F62;">        :param task: ä»»åŠ¡</span></span>
<span class="line"><span style="color:#032F62;">        :param receiver: æ¥æ”¶è€…</span></span>
<span class="line"><span style="color:#032F62;">        :param arg: å‚æ•°</span></span>
<span class="line"><span style="color:#032F62;">        :param env: ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#032F62;">        :param pending_task: ä»»åŠ¡æ‰¹æ¬¡</span></span>
<span class="line"><span style="color:#032F62;">        :param refer_llm_result: ä¸Šä¸€æ¬¡çš„ç»“æœ</span></span>
<span class="line"><span style="color:#032F62;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">@abstractmethod</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(self, </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                  task: </span><span style="color:#032F62;">&quot;TaskHeader&quot;</span><span style="color:#24292E;">, receiver: </span><span style="color:#032F62;">&quot;TaskHeader.Location&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                  arg: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">, env: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">, pending_task: </span><span style="color:#032F62;">&quot;TaskBatch&quot;</span><span style="color:#24292E;">, refer_llm_result: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">                  ):</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">        å¤„ç†å‡½æ•°å¹¶è¿”å›å›å†™ç»“æœ</span></span>
<span class="line"><span style="color:#032F62;">        :param task: ä»»åŠ¡</span></span>
<span class="line"><span style="color:#032F62;">        :param receiver: æ¥æ”¶è€…</span></span>
<span class="line"><span style="color:#032F62;">        :param arg: å‚æ•°</span></span>
<span class="line"><span style="color:#032F62;">        :param env: ç¯å¢ƒå˜é‡</span></span>
<span class="line"><span style="color:#032F62;">        :param pending_task: ä»»åŠ¡æ‰¹æ¬¡</span></span>
<span class="line"><span style="color:#032F62;">        :param refer_llm_result: ä¸Šä¸€æ¬¡çš„ç»“æœ</span></span>
<span class="line"><span style="color:#032F62;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><code>callback</code> å‡½æ•°æš‚æ—¶æ²¡æœ‰ä»»ä½•ä½œç”¨ã€‚</p></div><p>æ„å»ºå…³é”®è¯å‚æ•°æ—¶è¯·è€ƒè™‘å›½é™…åŒ–ï¼Œä¸”å°½é‡é¿å¼€å…¬å…±å…³é”®è¯ï¼Œç¦æ­¢ä½¿ç”¨å•å­—å…³é”®è¯ã€‚</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>ç»§æ‰¿ <code>BaseTool</code> ç±»åï¼Œ<strong>ç¦æ­¢å®šä¹‰ <code>__init__</code></strong></p></div><h4 id="ğŸ³-åŠ¨æ€æ¿€æ´»" tabindex="-1">ğŸ³ åŠ¨æ€æ¿€æ´» <a class="header-anchor" href="#ğŸ³-åŠ¨æ€æ¿€æ´»" aria-label="Permalink to &quot;ğŸ³ åŠ¨æ€æ¿€æ´»&quot;">â€‹</a></h4><p>æ¯æ¬¡å¯¹è¯é€è¾¾åï¼Œä¼šé‡æ–°æ ¹æ®ç”¨æˆ·è¯­æ–™æ„å»ºæ–°çš„å‡½æ•°è¡¨ã€‚ æ’ä»¶é€‰æ‹©å™¨ä¼šæ ¹æ®å­—ç¬¦åŒ¹é…ç¡®å®šå“ªäº›æ˜¯å€™é€‰å‡½æ•°ï¼Œ <code>keywords</code> å’Œ <code>pattern</code> å‚æ•°å†³å®šäº†æ­¤æ¬¡å¯¹è¯æ˜¯å¦å€™é€‰æ­¤å‡½æ•°ã€‚</p><p><code>func_message</code> å‡½æ•°å†³å®šäº†æ˜¯å¦æ¿€æ´»æ­¤å‡½æ•°ã€‚</p><p><code>file_match_required</code> è¢«å®šä¹‰åï¼Œä¼šåœ¨æ–‡ä»¶æ¶ˆæ¯ä¸­è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸåˆ™æ¿€æ´»æ­¤å‡½æ•°ï¼Œå¦åˆ™ç¦ç”¨ï¼</p><p><code>deploy_child</code> å‚æ•°å†³å®šäº†æ­¤å‡½æ•°æ˜¯å¦ç»§ç»­å‘ä¸‹ä¼ é€’ï¼ˆç»“æŸæ ‡è®°ï¼‰ã€‚</p><p>æ¯æ¬¡é€’å½’ï¼Œä¸Šæ¬¡çš„å‡½æ•°ä¼šè¢«å¿½ç•¥ï¼Œå¦‚æœå¸Œæœ›å‡½æ•°å¯ä»¥é‡å¤ä½¿ç”¨ï¼Œå¯ä»¥è®¾ç½® <code>repeatable</code> å±æ€§ã€‚</p><p>é»˜è®¤é“¾é€’å½’æ·±åº¦ä¸º 6ï¼Œé€šè¿‡ <code>limit_child</code> å±æ€§å®šä¹‰ã€‚<strong>æ’ä»¶ç¦æ­¢é‡æ–°å®šä¹‰æ­¤å‚æ•°ã€‚</strong></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>æ–°å¯¹è¯é“¾è¢«å¯åŠ¨æ—¶ï¼Œä¼šåœ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ç»§æ‰¿ä¸Šä¸€ä¸ªå¯¹è¯é“¾çš„å‡½æ•°å±æ€§ã€‚</p></div><h4 id="ğŸ§ƒ-env-å£°æ˜æˆæƒç³»ç»Ÿ" tabindex="-1">ğŸ§ƒ Env å£°æ˜æˆæƒç³»ç»Ÿ <a class="header-anchor" href="#ğŸ§ƒ-env-å£°æ˜æˆæƒç³»ç»Ÿ" aria-label="Permalink to &quot;ğŸ§ƒ Env å£°æ˜æˆæƒç³»ç»Ÿ&quot;">â€‹</a></h4><ul><li>å£°æ˜</li></ul><p>è®¾ç½® <code>env_required</code> å±æ€§ï¼Œå£°æ˜éœ€è¦çš„å¸¸é‡ã€‚</p><ul><li>è®¾ç½®æ–‡æ¡£</li></ul><p>å­ç±»é‡å†™ <code>env_help_docs</code> å‡½æ•°ï¼Œè¿”å›å¸®åŠ©æ–‡æ¡£ã€‚æ­¤æ–‡æ¡£ä¼šåœ¨ç¼ºå¤±å˜é‡æ—¶è°ƒç”¨ï¼Œè¢«å‘é€ç»™ç”¨æˆ·ã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(self,</span></span>
<span class="line"><span style="color:#E1E4E8;">              task: </span><span style="color:#9ECBFF;">&quot;TaskHeader&quot;</span><span style="color:#E1E4E8;">, receiver: </span><span style="color:#9ECBFF;">&quot;TaskHeader.Location&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">              arg: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">, env: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">, pending_task: </span><span style="color:#9ECBFF;">&quot;TaskBatch&quot;</span><span style="color:#E1E4E8;">, refer_llm_result: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">None</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">              ):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">print</span><span style="color:#E1E4E8;">(env)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(self,</span></span>
<span class="line"><span style="color:#24292E;">              task: </span><span style="color:#032F62;">&quot;TaskHeader&quot;</span><span style="color:#24292E;">, receiver: </span><span style="color:#032F62;">&quot;TaskHeader.Location&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">              arg: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">, env: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">, pending_task: </span><span style="color:#032F62;">&quot;TaskBatch&quot;</span><span style="color:#24292E;">, refer_llm_result: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">None</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">              ):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;">(env)</span></span></code></pre></div><h3 id="ğŸ¥„-æ³¨å†Œå…ƒä¿¡æ¯" tabindex="-1">ğŸ¥„ æ³¨å†Œå…ƒä¿¡æ¯ <a class="header-anchor" href="#ğŸ¥„-æ³¨å†Œå…ƒä¿¡æ¯" aria-label="Permalink to &quot;ğŸ¥„ æ³¨å†Œå…ƒä¿¡æ¯&quot;">â€‹</a></h3><p>æ ¸å¿ƒç±» <code>PluginMetadata</code> ï¼Œæ‚¨å¯ä»¥åœ¨ <a href="https://github.com/LlmKira/Openaibot/blob/main/llmkira/sdk/func_calling/schema.py#L84" target="_blank" rel="noreferrer">è¿™é‡Œ</a> æŸ¥çœ‹å®ƒçš„ç»„æˆç»“æ„ã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># åç§°</span></span>
<span class="line"><span style="color:#E1E4E8;">__plugin_name__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">__openapi_version__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">PluginMetadata, FuncPair </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># import</span></span>
<span class="line"><span style="color:#6A737D;"># ä¸­é—´æ˜¯å‡½æ•°ä»£ç ......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æ ¸å¿ƒå…ƒä¿¡æ¯</span></span>
<span class="line"><span style="color:#E1E4E8;">__plugin_meta__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> PluginMetadata(</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">__plugin_name__,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;Search videos on bilibili.com(å“”å“©å“”å“©)&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">usage</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;search &lt;keywords&gt;&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line diff add"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">openapi_version</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">__openapi_version__,  </span><span style="color:#6A737D;"># OPENAPI ç‰ˆæœ¬ </span></span>
<span class="line diff add"><span style="color:#E1E4E8;">    </span><span style="color:#FFAB70;">function</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">{</span></span>
<span class="line diff add"><span style="color:#E1E4E8;">        FuncPair(</span><span style="color:#FFAB70;">function</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">bilibili, </span><span style="color:#FFAB70;">tool</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">BiliBiliSearch)  </span><span style="color:#6A737D;"># å‡½æ•°ç±»å’Œå·¥å…·ç±»</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#6A737D;"># åç§°</span></span>
<span class="line"><span style="color:#24292E;">__plugin_name__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;search_in_bilibili&quot;</span></span>
<span class="line"><span style="color:#24292E;">__openapi_version__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">PluginMetadata, FuncPair </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># import</span></span>
<span class="line"><span style="color:#6A737D;"># ä¸­é—´æ˜¯å‡½æ•°ä»£ç ......</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æ ¸å¿ƒå…ƒä¿¡æ¯</span></span>
<span class="line"><span style="color:#24292E;">__plugin_meta__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> PluginMetadata(</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">__plugin_name__,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Search videos on bilibili.com(å“”å“©å“”å“©)&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#E36209;">usage</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;search &lt;keywords&gt;&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line diff add"><span style="color:#24292E;">    </span><span style="color:#E36209;">openapi_version</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">__openapi_version__,  </span><span style="color:#6A737D;"># OPENAPI ç‰ˆæœ¬ </span></span>
<span class="line diff add"><span style="color:#24292E;">    </span><span style="color:#E36209;">function</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">{</span></span>
<span class="line diff add"><span style="color:#24292E;">        FuncPair(</span><span style="color:#E36209;">function</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">bilibili, </span><span style="color:#E36209;">tool</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">BiliBiliSearch)  </span><span style="color:#6A737D;"># å‡½æ•°ç±»å’Œå·¥å…·ç±»</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">)</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>FuncPair</code> ç»‘å®š <code>function</code> å‡½æ•°ç±»å’Œ <code>tool</code> å·¥å…·ç±»ã€‚</p></div><p><code>openapi_version</code> å‚æ•°è®°å½•å½“å‰åŒæ­¥ç‰ˆæœ¬ï¼Œå¦‚æœå®¿ä¸»æ¡†æ¶æ›´æ–°ï¼ŒPlugin å¯èƒ½éœ€è¦åŒæ­¥æ­¤å‚æ•°ä»¥æ”¯æŒæ–°æ¥å£ã€‚</p><div class="tip custom-block"><p class="custom-block-title">ä»€ä¹ˆæ—¶å€™éœ€è¦æ›´æ–°æˆ‘çš„æ’ä»¶ï¼Ÿ</p><p>OpenAPI ç»„ä»¶ä¼šè®¾å®šå“ªäº›ç‰ˆæœ¬çš„æ’ä»¶å¯ä»¥è¢«åŠ è½½ï¼Œå¦‚æœæ‚¨çš„æ’ä»¶ç‰ˆæœ¬è¿‡ä½ï¼Œä¼šæŠ¥é”™ï¼Œå±Šæ—¶æ‚¨å°†æ”¶åˆ°ç”¨æˆ·çš„ Issueã€‚</p></div><h3 id="ğŸ¥¥-å‰éªŒè§¦å‘å™¨" tabindex="-1">ğŸ¥¥ å‰éªŒè§¦å‘å™¨ <a class="header-anchor" href="#ğŸ¥¥-å‰éªŒè§¦å‘å™¨" aria-label="Permalink to &quot;ğŸ¥¥ å‰éªŒè§¦å‘å™¨&quot;">â€‹</a></h3><p>ä½¿ç”¨è¿™ä¸ªè£…é¥°å™¨æ¥é˜»æ­¢æˆ–é€šè¿‡ç‰¹å®šç¬¦åˆæ¡ä»¶çš„å“åº”ã€‚ ç”¨äºæ•æ„Ÿè¯è¿‡æ»¤ï¼Œç‰¹æ®Šè¯­æ®µæ— å‘½ä»¤ä¸»åŠ¨å“åº”ï¼ŒåŠ¨æ€é…ç½®å“åº”æ‰³æœºï¼Œæ‹’ç»æŸäº›ç”¨æˆ·å›ç­”ç­‰åœºæ™¯ã€‚</p><div class="language-jupyterpython vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">jupyterpython</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">@resign_trigger(Trigger(on_platform=&quot;telegram&quot;, action=&quot;deny&quot;, priority=0))</span></span>
<span class="line"><span style="color:#e1e4e8;">async def on_chat_message(message: str, uid: str, **kwargs):</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">    :param message: RawMessage</span></span>
<span class="line"><span style="color:#e1e4e8;">    :return:</span></span>
<span class="line"><span style="color:#e1e4e8;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">    if &quot;&lt;hello&gt;&quot; in message:</span></span>
<span class="line"><span style="color:#e1e4e8;">        return True</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">@resign_trigger(Trigger(on_platform=&quot;telegram&quot;, action=&quot;deny&quot;, priority=0))</span></span>
<span class="line"><span style="color:#24292e;">async def on_chat_message(message: str, uid: str, **kwargs):</span></span>
<span class="line"><span style="color:#24292e;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292e;">    :param message: RawMessage</span></span>
<span class="line"><span style="color:#24292e;">    :return:</span></span>
<span class="line"><span style="color:#24292e;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292e;">    if &quot;&lt;hello&gt;&quot; in message:</span></span>
<span class="line"><span style="color:#24292e;">        return True</span></span></code></pre></div><p>å‡½æ•°è¿”å› <code>True</code> åˆ™è¯´æ˜éœ€è¦å‰ç½®åŠ¨ä½œã€‚</p><h3 id="ğŸ”¨-é”™è¯¯ç¦ç”¨" tabindex="-1">ğŸ”¨ é”™è¯¯ç¦ç”¨ <a class="header-anchor" href="#ğŸ”¨-é”™è¯¯ç¦ç”¨" aria-label="Permalink to &quot;ğŸ”¨ é”™è¯¯ç¦ç”¨&quot;">â€‹</a></h3><p>ä½¿ç”¨è¿™ä¸ªè£…é¥°å™¨æ¥ç›‘æµ‹è¡ŒåŠ¨å‡½æ•°çš„é”™è¯¯ã€‚é”™è¯¯æ¬¡æ•°è¢«è®°å½•è¿‡å¤šåï¼Œæ­¤å‡½æ•°æ’ä»¶å°±ä¸è¢«è°ƒç”¨äº†ã€‚</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> llmkira.sdk.openapi.fuse </span><span style="color:#F97583;">import</span><span style="color:#E1E4E8;"> resign_plugin_executor</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">@resign_plugin_executor</span><span style="color:#E1E4E8;">(</span><span style="color:#FFAB70;">function</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">search, </span><span style="color:#FFAB70;">handle_exceptions</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">Exception</span><span style="color:#E1E4E8;">,))</span></span>
<span class="line"><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">search_in_bilibili</span><span style="color:#E1E4E8;">(arg: </span><span style="color:#79B8FF;">dict</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">kwargs):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">pass</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> llmkira.sdk.openapi.fuse </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> resign_plugin_executor</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">@resign_plugin_executor</span><span style="color:#24292E;">(</span><span style="color:#E36209;">function</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">search, </span><span style="color:#E36209;">handle_exceptions</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">Exception</span><span style="color:#24292E;">,))</span></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">search_in_bilibili</span><span style="color:#24292E;">(arg: </span><span style="color:#005CC5;">dict</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">kwargs):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">pass</span></span></code></pre></div><p>æ³¨æ„è¿™æ˜¯ä¸€ä¸ªåŒæ­¥è£…é¥°å™¨ï¼Œå¦‚æœæ‚¨çš„å‡½æ•°æ˜¯å¼‚æ­¥çš„ï¼Œå¯ä»¥è°ƒç”¨ utils.sync è¿è¡Œå¼‚æ­¥å‡½æ•°ã€‚</p><h3 id="ğŸ©-è·¯ç”±é€šä¿¡" tabindex="-1">ğŸ© è·¯ç”±é€šä¿¡ <a class="header-anchor" href="#ğŸ©-è·¯ç”±é€šä¿¡" aria-label="Permalink to &quot;ğŸ© è·¯ç”±é€šä¿¡&quot;">â€‹</a></h3><p>æˆ‘ä»¬é€šè¿‡å®šä¹‰ä»»åŠ¡æ¶ˆæ¯ä¸­çš„ <code>Meta</code> å’Œ <code>Location</code> å‘å„ä¸ªå¹³å°è·¯ç”±é€šä¿¡ã€‚å…·ä½“ä¾‹å­å¦‚ä¸‹ï¼š</p><p>Location ç»§æ‰¿è¿‡æ¥å³å¯ã€‚å› ä¸ºä½ ä¸çŸ¥é“å…¶ä»–ç”¨æˆ·æ˜¯è°ã€‚</p><h4 id="ğŸ“•-é€šä¿¡æ¨¡å¼" tabindex="-1">ğŸ“• é€šä¿¡æ¨¡å¼ <a class="header-anchor" href="#ğŸ“•-é€šä¿¡æ¨¡å¼" aria-label="Permalink to &quot;ğŸ“• é€šä¿¡æ¨¡å¼&quot;">â€‹</a></h4><p><code>Meta</code> æœ‰å¦‚ä¸‹å†…éƒ¨ç»´æŠ¤çš„æ„é€ å‡½æ•°ï¼š</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>è¯·æ³¨æ„ï¼Œ<code>callback</code> å‚æ•°æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ <strong>ä¸€ä¸ªæˆ–å¤šä¸ª</strong> <code>TaskHeader.Meta.Callback.create</code>æ„å»ºçš„å¯¹è±¡å¡«å……æ­¤åˆ—è¡¨ã€‚</p></div><h5 id="ğŸ“reply-notify-é€šçŸ¥å›å¤" tabindex="-1">ğŸ“<code>reply_notify</code> é€šçŸ¥å›å¤ <a class="header-anchor" href="#ğŸ“reply-notify-é€šçŸ¥å›å¤" aria-label="Permalink to &quot;ğŸ“`reply_notify` é€šçŸ¥å›å¤&quot;">â€‹</a></h5><p>ä»…ä»…é€šçŸ¥ï¼Œä¸å›å†™è®°å¿†è®°å½•ï¼Œä¹Ÿä¸è§¦å‘ä»»ä½•å¤„ç†ã€‚</p><p>ç”¨äºé”™è¯¯é€šçŸ¥æˆ–å•å‘é€šçŸ¥ã€‚</p><p><em>é€‚ç”¨æ¶ˆæ¯å†…å®¹ä¸¾ä¾‹</em></p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">å‘ç”Ÿäº†é”™è¯¯ï¼Œæ‚¨æ²¡æœ‰é…ç½®æ’ä»¶éœ€è¦çš„å¸¸é‡ã€‚</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">å‘ç”Ÿäº†é”™è¯¯ï¼Œæ‚¨æ²¡æœ‰é…ç½®æ’ä»¶éœ€è¦çš„å¸¸é‡ã€‚</span></span></code></pre></div><h5 id="ğŸ“reply-raw-å›å¤ä¸å¯è¯»å†…å®¹" tabindex="-1">ğŸ“<code>reply_raw</code> å›å¤ä¸å¯è¯»å†…å®¹ <a class="header-anchor" href="#ğŸ“reply-raw-å›å¤ä¸å¯è¯»å†…å®¹" aria-label="Permalink to &quot;ğŸ“`reply_raw` å›å¤ä¸å¯è¯»å†…å®¹&quot;">â€‹</a></h5><p>æ­¤æ¶ˆæ¯ä¼šè¢«å›å†™è¿›è®°å¿†è®°å½•ï¼Œä½œä¸ºè¢«æŸ¥è¯¢çš„å¯¹è±¡ï¼Œç”±LLMå¤„ç†åä»£ä¸ºç­”å¤ã€‚æ¯”å¦‚æœç´¢ï¼Œæ•°æ®é›†æŸ¥è¯¢ç»“æœã€‚</p><p><em>é€‚ç”¨æ¶ˆæ¯å†…å®¹ä¸¾ä¾‹</em></p><div class="language-json5 vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json5</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&quot;query&quot;</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;æŸ¥è¯¢å†…å®¹&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">&quot;item&quot;</span><span style="color:#E1E4E8;">: [</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;æŸ¥è¯¢ç»“æœ1&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;æŸ¥è¯¢ç»“æœ2&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;æŸ¥è¯¢ç»“æœ3&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  ]</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;query&quot;</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;æŸ¥è¯¢å†…å®¹&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">&quot;item&quot;</span><span style="color:#24292E;">: [</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;æŸ¥è¯¢ç»“æœ1&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;æŸ¥è¯¢ç»“æœ2&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;æŸ¥è¯¢ç»“æœ3&quot;</span></span>
<span class="line"><span style="color:#24292E;">  ]</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p><strong><code>reply_raw</code> ä¸èƒ½å›å¤æ–‡ä»¶æ¶ˆæ¯ã€‚</strong></p></div><h5 id="ğŸ“reply-message-å›å¤å¯è¯»å†…å®¹-æ–‡ä»¶æ¶ˆæ¯" tabindex="-1">ğŸ“<code>reply_message</code> å›å¤å¯è¯»å†…å®¹/æ–‡ä»¶æ¶ˆæ¯ <a class="header-anchor" href="#ğŸ“reply-message-å›å¤å¯è¯»å†…å®¹-æ–‡ä»¶æ¶ˆæ¯" aria-label="Permalink to &quot;ğŸ“`reply_message` å›å¤å¯è¯»å†…å®¹/æ–‡ä»¶æ¶ˆæ¯&quot;">â€‹</a></h5><p>æ­¤æ¶ˆæ¯é€‚ç”¨äºæ‰§è¡Œå›å¤ã€‚å›å¤äººç±»å¯è¯»çš„å†…å®¹ã€‚å›å†™è®°å¿†è®°å½•ï¼Œç›´æ¥å›å¤ã€‚</p><p><em>é€‚ç”¨æ¶ˆæ¯å†…å®¹ä¸¾ä¾‹</em></p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">æŸ¥è¯¢å®Œæ¯•ï¼Œæ‚¨çš„åŸç¥è´¦å·ä¸ºï¼š123456789</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">æŸ¥è¯¢å®Œæ¯•ï¼Œæ‚¨çš„åŸç¥è´¦å·ä¸ºï¼š123456789</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">æ–‡ä»¶æ¶ˆæ¯</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">æ–‡ä»¶æ¶ˆæ¯</span></span></code></pre></div><h4 id="ğŸ“•-è‡ªå®šä¹‰é€šä¿¡æ¨¡å¼" tabindex="-1">ğŸ“• è‡ªå®šä¹‰é€šä¿¡æ¨¡å¼ <a class="header-anchor" href="#ğŸ“•-è‡ªå®šä¹‰é€šä¿¡æ¨¡å¼" aria-label="Permalink to &quot;ğŸ“• è‡ªå®šä¹‰é€šä¿¡æ¨¡å¼&quot;">â€‹</a></h4><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark has-focused-lines vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">__plugin_name__ </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">task </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">receiver </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">_search_result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">Task, TaskHeader, RawMessage </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">pending_task </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">...</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">_meta </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> task.task_meta.child(__plugin_name__)  </span><span style="color:#6A737D;"># è‡ªå®šä¹‰ </span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">_meta.callback_forward </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">True</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">_meta.callback_forward_reprocess </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">False</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">_meta.direct_reply </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">False</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">_meta.write_back </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">True</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">_meta.release_chain </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">True</span></span>
<span class="line has-focus"><span style="color:#E1E4E8;">_meta.callback </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span></span>
<span class="line"><span style="color:#E1E4E8;">    TaskHeader.Meta.Callback.create(</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">__plugin_name__,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">function_response</span><span style="color:#F97583;">=</span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;Run Failed&quot;</span><span style="color:#E1E4E8;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">tool_call_id</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">pending_task.get_batch_id()</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span>
<span class="line"><span style="color:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> Task.create_and_send(</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">queue_name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">receiver.platform,</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#FFAB70;">task</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">TaskHeader(</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">sender</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">task.sender,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">receiver</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">receiver,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">task_meta</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">_meta,</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#FFAB70;">message</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">[</span></span>
<span class="line"><span style="color:#E1E4E8;">                RawMessage(</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#FFAB70;">user_id</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">receiver.user_id,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#FFAB70;">chat_id</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">receiver.chat_id,</span></span>
<span class="line"><span style="color:#E1E4E8;">                    </span><span style="color:#FFAB70;">text</span><span style="color:#F97583;">=</span><span style="color:#F97583;">f</span><span style="color:#9ECBFF;">&quot;ğŸ–</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">__plugin_name__</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;"> Run Failedï¼š</span><span style="color:#79B8FF;">{</span><span style="color:#E1E4E8;">exception</span><span style="color:#79B8FF;">}</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">                )</span></span>
<span class="line"><span style="color:#E1E4E8;">            ]</span></span>
<span class="line"><span style="color:#E1E4E8;">        )</span></span>
<span class="line"><span style="color:#E1E4E8;">    )</span></span></code></pre><pre class="shiki github-light has-focused-lines vp-code-light"><code><span class="line"><span style="color:#24292E;">__plugin_name__ </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">task </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">receiver </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">_search_result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">Task, TaskHeader, RawMessage </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">pending_task </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">...</span></span>
<span class="line has-focus"><span style="color:#24292E;">_meta </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> task.task_meta.child(__plugin_name__)  </span><span style="color:#6A737D;"># è‡ªå®šä¹‰ </span></span>
<span class="line has-focus"><span style="color:#24292E;">_meta.callback_forward </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">True</span></span>
<span class="line has-focus"><span style="color:#24292E;">_meta.callback_forward_reprocess </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">False</span></span>
<span class="line has-focus"><span style="color:#24292E;">_meta.direct_reply </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">False</span></span>
<span class="line has-focus"><span style="color:#24292E;">_meta.write_back </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">True</span></span>
<span class="line has-focus"><span style="color:#24292E;">_meta.release_chain </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">True</span></span>
<span class="line has-focus"><span style="color:#24292E;">_meta.callback </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span></span>
<span class="line"><span style="color:#24292E;">    TaskHeader.Meta.Callback.create(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">__plugin_name__,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">function_response</span><span style="color:#D73A49;">=</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;Run Failed&quot;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">tool_call_id</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">pending_task.get_batch_id()</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> Task.create_and_send(</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">queue_name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">receiver.platform,</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#E36209;">task</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">TaskHeader(</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">sender</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">task.sender,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">receiver</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">receiver,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">task_meta</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">_meta,</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#E36209;">message</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">[</span></span>
<span class="line"><span style="color:#24292E;">                RawMessage(</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#E36209;">user_id</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">receiver.user_id,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#E36209;">chat_id</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">receiver.chat_id,</span></span>
<span class="line"><span style="color:#24292E;">                    </span><span style="color:#E36209;">text</span><span style="color:#D73A49;">=</span><span style="color:#D73A49;">f</span><span style="color:#032F62;">&quot;ğŸ–</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">__plugin_name__</span><span style="color:#005CC5;">}</span><span style="color:#032F62;"> Run Failedï¼š</span><span style="color:#005CC5;">{</span><span style="color:#24292E;">exception</span><span style="color:#005CC5;">}</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">                )</span></span>
<span class="line"><span style="color:#24292E;">            ]</span></span>
<span class="line"><span style="color:#24292E;">        )</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span></code></pre></div><p>å…¶ä¸­ï¼Œ<code>task_meta</code> å‚æ•°å¿…é¡»ç”±å‡½æ•°ä¼ é€’çš„ <code>task_meta</code> çš„ <code>child</code> å‡½æ•°å…‹éš†è¿‡æ¥ã€‚</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>ç¦æ­¢ä¿®æ”¹ <code>continue_step</code> å’Œ <code>limit_child</code> å±æ€§ï¼Œå½±å“é€’å½’æ·±åº¦ã€‚</p></div><h2 id="ğŸƒ-åœ¨æ’ä»¶ä¸­è®¿é—®-åˆ›å»ºæ–‡ä»¶" tabindex="-1">ğŸƒ åœ¨æ’ä»¶ä¸­è®¿é—®/åˆ›å»ºæ–‡ä»¶ <a class="header-anchor" href="#ğŸƒ-åœ¨æ’ä»¶ä¸­è®¿é—®-åˆ›å»ºæ–‡ä»¶" aria-label="Permalink to &quot;ğŸƒ åœ¨æ’ä»¶ä¸­è®¿é—®/åˆ›å»ºæ–‡ä»¶&quot;">â€‹</a></h2><p>Redis ä¸Šä¼ ä¸‹è½½ä¾èµ–ä¸€ä¸ªçŸ­æ–‡ä»¶ IDã€‚</p><p>å‚è€ƒä»¥ä¸‹å¤„ç†</p><h3 id="ğŸ“¥-ä¸‹è½½æ–‡ä»¶" tabindex="-1">ğŸ“¥ ä¸‹è½½æ–‡ä»¶ <a class="header-anchor" href="#ğŸ“¥-ä¸‹è½½æ–‡ä»¶" aria-label="Permalink to &quot;ğŸ“¥ ä¸‹è½½æ–‡ä»¶&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">(self, task: TaskHeader, receiver: TaskHeader.Location, arg, </span><span style="color:#F97583;">**</span><span style="color:#E1E4E8;">kwargs):</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">    å¤„ç†messageï¼Œè¿”å›message</span></span>
<span class="line"><span style="color:#9ECBFF;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    _translate_file </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> []</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> item </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> task.message:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> item.file:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> item.file:</span></span>
<span class="line"><span style="color:#E1E4E8;">                _translate_file.append(i)</span></span>
<span class="line"><span style="color:#E1E4E8;">        _file_obj </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> i.raw_file()</span></span>
<span class="line"><span style="color:#E1E4E8;">                     </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> i </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">sorted</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">set</span><span style="color:#E1E4E8;">(_translate_file), </span><span style="color:#FFAB70;">key</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">_translate_file.index)]</span></span>
<span class="line"><span style="color:#E1E4E8;">        _file_obj </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> [item </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> item </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> _file_obj </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> item]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">(self, task: TaskHeader, receiver: TaskHeader.Location, arg, </span><span style="color:#D73A49;">**</span><span style="color:#24292E;">kwargs):</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#032F62;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#032F62;">    å¤„ç†messageï¼Œè¿”å›message</span></span>
<span class="line"><span style="color:#032F62;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#24292E;">    _translate_file </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> []</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> item </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> task.message:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> item.file:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> item.file:</span></span>
<span class="line"><span style="color:#24292E;">                _translate_file.append(i)</span></span>
<span class="line"><span style="color:#24292E;">        _file_obj </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> i.raw_file()</span></span>
<span class="line"><span style="color:#24292E;">                     </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> i </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">sorted</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">set</span><span style="color:#24292E;">(_translate_file), </span><span style="color:#E36209;">key</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">_translate_file.index)]</span></span>
<span class="line"><span style="color:#24292E;">        _file_obj </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> [item </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> item </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> _file_obj </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> item]</span></span></code></pre></div><h3 id="ğŸ“¤-ä¸Šä¼ æ–‡ä»¶" tabindex="-1">ğŸ“¤ ä¸Šä¼ æ–‡ä»¶ <a class="header-anchor" href="#ğŸ“¤-ä¸Šä¼ æ–‡ä»¶" aria-label="Permalink to &quot;ğŸ“¤ ä¸Šä¼ æ–‡ä»¶&quot;">â€‹</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">async</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">def</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">test</span><span style="color:#E1E4E8;">():</span></span>
<span class="line"><span style="color:#E1E4E8;">    file_obj </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">await</span><span style="color:#E1E4E8;"> File.upload_file(</span><span style="color:#FFAB70;">file_name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">file_name,</span></span>
<span class="line"><span style="color:#E1E4E8;">                                      </span><span style="color:#FFAB70;">file_data</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">file_data,</span></span>
<span class="line"><span style="color:#E1E4E8;">                                      </span><span style="color:#FFAB70;">created_by</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">uid</span></span>
<span class="line"><span style="color:#E1E4E8;">                                      )</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Use utils.sync to convert async to sync</span></span>
<span class="line"><span style="color:#E1E4E8;">    file_obj </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> sync(File.upload_file(</span><span style="color:#FFAB70;">file_name</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">file_name,</span></span>
<span class="line"><span style="color:#E1E4E8;">                                     </span><span style="color:#FFAB70;">file_data</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">file_data,</span></span>
<span class="line"><span style="color:#E1E4E8;">                                     </span><span style="color:#FFAB70;">created_by</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">uid</span></span>
<span class="line"><span style="color:#E1E4E8;">                                     )</span></span>
<span class="line"><span style="color:#E1E4E8;">                    )</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">async</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">test</span><span style="color:#24292E;">():</span></span>
<span class="line"><span style="color:#24292E;">    file_obj </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">await</span><span style="color:#24292E;"> File.upload_file(</span><span style="color:#E36209;">file_name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">file_name,</span></span>
<span class="line"><span style="color:#24292E;">                                      </span><span style="color:#E36209;">file_data</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">file_data,</span></span>
<span class="line"><span style="color:#24292E;">                                      </span><span style="color:#E36209;">created_by</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">uid</span></span>
<span class="line"><span style="color:#24292E;">                                      )</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Use utils.sync to convert async to sync</span></span>
<span class="line"><span style="color:#24292E;">    file_obj </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> sync(File.upload_file(</span><span style="color:#E36209;">file_name</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">file_name,</span></span>
<span class="line"><span style="color:#24292E;">                                     </span><span style="color:#E36209;">file_data</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">file_data,</span></span>
<span class="line"><span style="color:#24292E;">                                     </span><span style="color:#E36209;">created_by</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">uid</span></span>
<span class="line"><span style="color:#24292E;">                                     )</span></span>
<span class="line"><span style="color:#24292E;">                    )</span></span></code></pre></div><p><code>file_id</code> åªèƒ½æ˜¯ Redis å­˜æ”¾æ–‡ä»¶çš„é”®åï¼Œä¸èƒ½éšä¾¿å†™ã€‚</p><p>å¦‚æœä½ è¦ä½¿ç”¨ <code>url</code> ä¸Šä¼ ï¼Œè¯·ä½¿ç”¨ <code>File</code> çš„ç±»æ–¹æ³•ã€‚</p><h2 id="ğŸ“©-æ³¨å†Œ-entrypoint-group" tabindex="-1">ğŸ“© æ³¨å†Œ EntryPoint Group <a class="header-anchor" href="#ğŸ“©-æ³¨å†Œ-entrypoint-group" aria-label="Permalink to &quot;ğŸ“© æ³¨å†Œ EntryPoint Group&quot;">â€‹</a></h2><p>æ–‡æ¡£å‚è€ƒ <a href="https://python-poetry.org/docs/pyproject/#plugins" target="_blank" rel="noreferrer">https://python-poetry.org/docs/pyproject/#plugins</a></p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#B392F0;">tool</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">poetry</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">plugins</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">&quot;llmkira</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">extra</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">plugin&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#6A737D;"># The entrypoint name is the name of the plugin.</span></span>
<span class="line"><span style="color:#6A737D;"># å‰é¢å’Œåé¢éƒ½è¦å”¯ä¸€ï¼Œæ³¨å†Œé’©å­çš„æ—¶å€™ä¼šç”¨åˆ°</span></span>
<span class="line"><span style="color:#E1E4E8;">bilisearch = </span><span style="color:#9ECBFF;">&quot;llmbot_plugin_bilisearch&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#6F42C1;">tool</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">poetry</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">plugins</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">&quot;llmkira</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">extra</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">plugin&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#6A737D;"># The entrypoint name is the name of the plugin.</span></span>
<span class="line"><span style="color:#6A737D;"># å‰é¢å’Œåé¢éƒ½è¦å”¯ä¸€ï¼Œæ³¨å†Œé’©å­çš„æ—¶å€™ä¼šç”¨åˆ°</span></span>
<span class="line"><span style="color:#24292E;">bilisearch = </span><span style="color:#032F62;">&quot;llmbot_plugin_bilisearch&quot;</span></span></code></pre></div><p>ç­‰å·çš„åé¢æ˜¯æ’ä»¶çš„åŒ…åï¼Œå‰é¢æ˜¯å”¯ä¸€é”®ï¼ˆè¯·ç¡®ä¿ä¸ä¼šä¸å…¶ä»–æ’ä»¶å†²çªï¼‰</p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#B392F0;">tool</span><span style="color:#E1E4E8;">.</span><span style="color:#B392F0;">poetry</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">name = </span><span style="color:#9ECBFF;">&quot;llmbot_plugin_bilisearch&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#6F42C1;">tool</span><span style="color:#24292E;">.</span><span style="color:#6F42C1;">poetry</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">name = </span><span style="color:#032F62;">&quot;llmbot_plugin_bilisearch&quot;</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>ä½ <strong>å¿…é¡»æ³¨å†Œ</strong> EntryPoint æ‰èƒ½è¢«æœºå™¨äººå¯åŠ¨ç¨‹åºæ£€ç´¢åˆ°ã€‚</p></div><h2 id="ğŸ”¨-å‘å¸ƒåŒ…" tabindex="-1">ğŸ”¨ å‘å¸ƒåŒ… <a class="header-anchor" href="#ğŸ”¨-å‘å¸ƒåŒ…" aria-label="Permalink to &quot;ğŸ”¨ å‘å¸ƒåŒ…&quot;">â€‹</a></h2><p><code>poetry publish</code> å‘å¸ƒåŒ…ï¼Œæˆ–è€…ä½¿ç”¨ CI è‡ªåŠ¨å‘å¸ƒã€‚</p><h3 id="ğŸ”§-ï¸åŒ…ç®¡ç†è¯´æ˜" tabindex="-1">ğŸ”§ ï¸åŒ…ç®¡ç†è¯´æ˜ <a class="header-anchor" href="#ğŸ”§-ï¸åŒ…ç®¡ç†è¯´æ˜" aria-label="Permalink to &quot;ğŸ”§ ï¸åŒ…ç®¡ç†è¯´æ˜&quot;">â€‹</a></h3><p>æ¯æ¬¡å‡çº§æ—¶ï¼Œéƒ½è¦æ›´æ–° <code>version</code> å­—æ®µã€‚</p><p>æ¯æ¬¡å˜æ›´ä¾èµ–æˆ–ä¿®æ”¹ä¾èµ–æ–‡ä»¶ <code>pyproject.toml</code>ï¼Œéƒ½è¦è¿è¡Œ <code>poetry lock</code> å‘½ä»¤æ›´æ–°ä¾èµ–é”ã€‚</p><p>ä½ å¯ä»¥åœ¨å‘å¸ƒå‰è¿è¡Œ <code>poetry install</code> å‘½ä»¤æ£€æŸ¥å¹¶å®‰è£…å½“å‰åº“åˆ°æœ¬åœ°ç¯å¢ƒã€‚</p><h3 id="âš™ï¸-ciè‡ªåŠ¨å‘å¸ƒ" tabindex="-1">âš™ï¸ CIè‡ªåŠ¨å‘å¸ƒ <a class="header-anchor" href="#âš™ï¸-ciè‡ªåŠ¨å‘å¸ƒ" aria-label="Permalink to &quot;âš™ï¸ CIè‡ªåŠ¨å‘å¸ƒ&quot;">â€‹</a></h3><p>åœ¨ <code>.github/workflows/publish.yml</code> æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ï¼š</p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">publish</span></span>
<span class="line"><span style="color:#79B8FF;">on</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">push</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">tags</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">v*</span></span>
<span class="line"><span style="color:#85E89D;">jobs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">release</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">runs-on</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ubuntu-latest</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">steps</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">uses</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">actions/checkout@v3</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Publish python package</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">uses</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">JRubics/poetry-publish@v1.16</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">with</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">pypi_token</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">${{ secrets.PYPI_TOKEN }}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">publish</span></span>
<span class="line"><span style="color:#005CC5;">on</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">push</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">tags</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">v*</span></span>
<span class="line"><span style="color:#22863A;">jobs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">release</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">runs-on</span><span style="color:#24292E;">: </span><span style="color:#032F62;">ubuntu-latest</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">steps</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">uses</span><span style="color:#24292E;">: </span><span style="color:#032F62;">actions/checkout@v3</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Publish python package</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">uses</span><span style="color:#24292E;">: </span><span style="color:#032F62;">JRubics/poetry-publish@v1.16</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">with</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">pypi_token</span><span style="color:#24292E;">: </span><span style="color:#032F62;">${{ secrets.PYPI_TOKEN }}</span></span></code></pre></div><p>ä»“åº“ä¸»ç•Œé¢å³ä¸‹è§’æ–°å»º <code>Release</code>, æ–°å»º <code>v</code> å¼€å¤´çš„æ ‡ç­¾ï¼Œåˆ›å»ºåå³å¯è§¦å‘è‡ªåŠ¨å‘å¸ƒã€‚</p></div></div></main><footer class="VPDocFooter" data-v-6b87e69f data-v-ef5dee53><!--[--><!--]--><div class="edit-info" data-v-ef5dee53><div class="edit-link" data-v-ef5dee53><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/LLMKira/Docs/edit/main/docs/dev/basic.md" target="_blank" rel="noreferrer" data-v-ef5dee53><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" aria-label="edit icon" data-v-ef5dee53><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Edit On GitHub<!--]--></a></div><div class="last-updated" data-v-ef5dee53><p class="VPLastUpdated" data-v-ef5dee53 data-v-7e05ebdb>Updated at: <time datetime="2023-11-14T15:28:55.000Z" data-v-7e05ebdb></time></p></div></div><nav class="prev-next" data-v-ef5dee53><div class="pager" data-v-ef5dee53><!----></div><div class="pager" data-v-ef5dee53><a class="pager-link next" href="/Docs/dev/middleware" data-v-ef5dee53><span class="desc" data-v-ef5dee53>Next page</span><span class="title" data-v-ef5dee53>ä¸­é—´ä»¶ä½¿ç”¨</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5a346dfe data-v-e03eb2e1><div class="container" data-v-e03eb2e1><p class="message" data-v-e03eb2e1>Released under the GFDL License.</p><p class="copyright" data-v-e03eb2e1>Copyright Â© 2022-present Kira</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"dev_arch.md\":\"58e2c4a4\",\"en_guide_maintain.md\":\"b56123b6\",\"guide_getting-started.md\":\"491c2697\",\"guide_maintain.md\":\"212d07a3\",\"guide_service.md\":\"cdd5a61a\",\"en_guide_service.md\":\"12058a5c\",\"index.md\":\"de464885\",\"en_index.md\":\"19b89f50\",\"dev_client.md\":\"e9ef9afd\",\"en_dev_arch.md\":\"41acadaf\",\"en_guide_command.md\":\"c5dae0db\",\"en_guide_getting-started.md\":\"79fa1cb5\",\"en_dev_client.md\":\"8313efe1\",\"guide_command.md\":\"e3cfd921\",\"en_dev_middleware.md\":\"02c4961e\",\"dev_middleware.md\":\"1f9581ce\",\"en_dev_basic.md\":\"f6412bdd\",\"dev_basic.md\":\"50613b2e\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"Openai Kira Org\",\"description\":\"Kira Kira Openaibot.\",\"base\":\"/Docs/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Deploy Guide\",\"link\":\"/guide/getting-started\",\"activeMatch\":\"/guide/\"},{\"text\":\"Dev Tutorials\",\"link\":\"/dev/basic\",\"activeMatch\":\"/dev/\"},{\"text\":\"About Repo\",\"items\":[{\"text\":\"Changelog\",\"link\":\"https://github.com/LLMKira/Openaibot/pulls?q=\"}]}],\"siteTitle\":\"LLMKira\",\"logo\":\"https://avatars.githubusercontent.com/u/124290462?s=200&v=4\",\"sidebar\":{\"/guide/\":[{\"text\":\"éƒ¨ç½²æŒ‡å—\",\"collapsed\":false,\"items\":[{\"text\":\"å¼€å§‹éƒ¨ç½²\",\"link\":\"/guide/getting-started\"},{\"text\":\"å­æœåŠ¡éƒ¨ä»¶\",\"link\":\"/guide/service\"},{\"text\":\"ç»´æŠ¤æœåŠ¡\",\"link\":\"/guide/maintain\"}]},{\"text\":\"ä½¿ç”¨æŒ‡å—\",\"collapsed\":false,\"items\":[{\"text\":\"äº¤äº’å‘½ä»¤\",\"link\":\"/guide/command\"}]}],\"/dev/\":[{\"text\":\"æ’ä»¶å¼€å‘æŒ‡å—\",\"items\":[{\"text\":\"å¿«é€Ÿå¼€å‘\",\"link\":\"/dev/basic\"},{\"text\":\"ä¸­é—´ä»¶ä½¿ç”¨\",\"link\":\"/dev/middleware\"}]},{\"text\":\"å¹³å°å¼€å‘æŒ‡å—\",\"items\":[{\"text\":\"æ¶æ„ä»‹ç»\",\"link\":\"/dev/arch\"},{\"text\":\"æ”¶å‘ç«¯\",\"link\":\"/dev/client\"}]}],\"/en/guide/\":[{\"text\":\"Deploy Guide\",\"collapsed\":false,\"items\":[{\"text\":\"Deploy\",\"link\":\"/en/guide/getting-started\"},{\"text\":\"Component\",\"link\":\"/en/guide/service\"},{\"text\":\"Maintain\",\"link\":\"/en/guide/maintain\"}]},{\"text\":\"Usage instructions\",\"collapsed\":false,\"items\":[{\"text\":\"Command\",\"link\":\"/en/guide/command\"}]}],\"/en/dev/\":[{\"text\":\"Plugin System\",\"items\":[{\"text\":\"Fast Dev\",\"link\":\"/en/dev/basic\"},{\"text\":\"Middleware\",\"link\":\"/en/dev/middleware\"}]},{\"text\":\"Platform Dev\",\"items\":[{\"text\":\"Arch\",\"link\":\"/en/dev/arch\"},{\"text\":\"Client\",\"link\":\"/en/dev/client\"}]}]},\"editLink\":{\"pattern\":\"https://github.com/LLMKira/Docs/edit/main/docs/:path\",\"text\":\"Edit On GitHub\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/LLMKira/Openaibot\"}],\"footer\":{\"message\":\"Released under the GFDL License.\",\"copyright\":\"Copyright Â© 2022-present Kira\"},\"lastUpdated\":{\"text\":\"Updated at\",\"formatOptions\":{\"dateStyle\":\"full\",\"timeStyle\":\"medium\"}},\"outline\":[1,3]},\"locales\":{\"root\":{\"label\":\"Chinese\",\"lang\":\"zh\",\"link\":\"/\"},\"en\":{\"label\":\"English\",\"lang\":\"en\",\"link\":\"/en/\"}},\"scrollOffset\":90,\"cleanUrls\":true}");</script>
    
  </body>
</html>