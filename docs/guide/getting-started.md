# ä½ å¥½ ğŸ‘‹

Openai Bot æ˜¯åŸºäº GPT ç³»åˆ—æ¨¡å‹(ä¸»è¦ä¸º Openai ) çš„æ¥å£å¼€å‘çš„ç³»åˆ—å¥—ä»¶ã€‚

é€šè¿‡éƒ¨ç½²æœ¬é¡¹ç›®ï¼Œä½ å¯ä»¥åœ¨ å¤šç§IMå¹³å°/Web å‰ç«¯/å®æœº ä¸Šä¸ GPT æ¨¡å‹äº¤äº’ã€‚

å¦‚æœä½ æ˜¯å¼€å‘è€…ï¼Œä½ å¯ä»¥æŸ¥çœ‹ `Dev Guide` æ¥ç†Ÿæ‚‰æˆ‘ä»¬çš„ç»„ä»¶ï¼Œå¼€å‘å…¶ä»–çš„æœ‰ç”¨çš„åº”ç”¨ã€‚

## æˆ‘ä»¬å’Œ ChatGPT çš„å…³ç³»

åŒçº§ï¼ŒChatGPT æ˜¯åŸºäºæ¨¡å‹çš„ Web åº”ç”¨ï¼Œå¦‚æœä½ æœ‰ ChatGpt æ¨¡å‹çš„è®¿é—®æƒé™ï¼Œç†è®ºå¯ä»¥åšåˆ°ä¸€è‡´ã€‚
æˆ‘ä»¬ä½¿ç”¨è‡ªç»´æŠ¤çš„ llm æ¡†æ¶ `llm-kira` å®ç°å¯¹è¯ä»£ç†ã€‚

## é¡¹ç›®ç‰¹æ€§

* å…¨ç¨‹å¼‚æ­¥å®ç°
* æ”¯æŒé€Ÿç‡é™åˆ¶
* æ”¯æŒç§èŠï¼Œç¾¤èŠ
* æ”¯æŒé»‘ç™½åå•ç³»ç»Ÿ
* æ”¯æŒç”¨é‡ç®¡ç†ï¼Œäººè®¾ï¼Œå®šåˆ¶`è¯`é£æ ¼
* è®°å¿†æ± ä¿è¯ä¸Šä¸‹æ–‡è®°å¿† 1000 è½®æœ‰æ•ˆ
* å¤šå¹³å°ï¼Œæ³›ç”¨æ€§å¼ºï¼Œè¿˜æ”¯æŒå®æœºè¯­éŸ³åŠ©æ‰‹
* å¤š Api key è½®è¯¢æ± ï¼Œä¾¿æ·ç®¡ç†ï¼Œè¶…é¢å¼¹å‡º
* æ”¯æŒä¸»åŠ¨å¯»æ‰¾å†…å®¹è¿›è¡Œå›å¤ï¼Œæ”¯æŒ Sticker å›å¤
* å¤šå¹³å°æ”¯æŒçš„é€šç”¨æ¥å£ï¼Œç†è®ºå¯ä»¥æ¥å…¥ä»»ä½•èŠå¤©å¹³å°
* å¯æ‹†å¸å†…å®¹å®‰å…¨æ¨¡å—ï¼Œè¿˜æ”¯æŒå®˜æ–¹çš„ Api å†…å®¹è¿‡æ»¤
* å®æ—¶ç½‘ç»œç´¢å¼•æ”¯æŒï¼Œé€šç”¨çš„æŠ“å–å™¨(æ”¯æŒUrlQueryHtmlå°±èƒ½æŠ“)
* å¤šæ¨¡æ€äº¤äº’æ”¯æŒï¼Œå›¾ç‰‡ `Blip` ç†è§£æ”¯æŒï¼Œè¯­éŸ³è¯†åˆ«ï¼Œè´´çº¸æ”¯æŒ

## éƒ¨ç½²

### å¯¹è®¾å¤‡çš„è¦æ±‚

æ­¤é¡¹ç›®çš„æœºå™¨

- æœ€å¥½æœ‰ 10 GB çš„ç£ç›˜ç©ºé—´
- æœ€å¥½æœ‰ 1 GB çš„å†…å­˜ï¼Œå¦‚æœéœ€è¦å¯ç”¨å›¾ç‰‡ç†è§£ï¼Œåˆ™éœ€è¦ 4GB
- æœ€å¥½åœ¨å›½å¤–è½åœ°
- å¯¹ CPU æ²¡æœ‰ç‰¹æ®Šè¦æ±‚ã€‚å¦‚æœä½ éœ€è¦å¯ç”¨ Vits æ”¯æŒï¼Œåˆ™éœ€è¦å¥½ä¸€äº›çš„ CPU
- ä¸éœ€è¦ GPUã€‚å¦‚æœéœ€è¦åŠ å¿«å›¾ç‰‡ç†è§£ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å“Ÿ~ğŸ¤—

### PM2

**ä¸€é”®è„šæœ¬**

- åœ¨æ ¹ç›®å½•è¿è¡Œä»¥ä¸‹è„šæœ¬è‡ªåŠ¨ å®‰è£…/æ›´æ–° ä¾èµ–å’Œé¡¹ç›®ã€‚

```shell
curl -LO https://raw.githubusercontent.com/LLMKira/Openaibot/main/setup.sh && sh setup.sh
```

- å®‰è£… PM2 è„šæœ¬ç®¡ç†å™¨

```shell
apt install npm
```

```shell
npm install pm2@latest -g
# or
yarn global add pm2
```

è¿™æ—¶å€™ï¼Œä½ å°±å¯ä»¥ `cd Openaibot`ï¼Œç„¶åä½¿ç”¨ `pm2 start pm2.json` å¯åŠ¨æœ¬é¡¹ç›®äº†ã€‚

**ä¸è¿‡å…ˆç­‰ä¸€ä¸‹ï¼** ä½ è¿˜éœ€è¦æµ‹è¯•å®ƒå¹¶ä¸”é…ç½®æ•°æ®åº“ç¯å¢ƒï¼Œå¦åˆ™pm2ä¼šæ— é™é‡è¯•é‡å¯è®©ä½ çš„ CPU æ»¡è½½ã€‚

å¹¸è¿çš„æ˜¯ï¼Œé…ç½®é¡¹ç›®çš„å…¶ä»–ç¯å¢ƒå¾ˆç®€å•ï¼Œè¯·çœ‹ä¸‹é¢çš„é…ç½®è¯´æ˜ã€‚

### Docker

* [Docker](https://hub.docker.com/r/LLMKira/Openaibot)

Docker é•œåƒåœ¨ä¿è¯æƒ…å†µ stable åæ‰ä¼šå‘å¸ƒæ›´æ–°ã€‚

```bash
git clone https://github.com/LLMKira/Openaibot
cd Openaibot
vim Config/service.json # è§ä¸‹é¢
docker compose up -d
```

æ¥ç€æˆ‘ä»¬éœ€è¦é…ç½®é¡¹ç›®çš„é…ç½®æ–‡ä»¶å’Œè¿è¡Œç¯å¢ƒï¼Œè¯·çœ‹ä¸‹é¢çš„é…ç½®è¯´æ˜ã€‚

## é…ç½®ä¾èµ–

å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ä¸€é”®è„šæœ¬ä¹Ÿæ²¡æœ‰ä½¿ç”¨ Dockerï¼Œé‚£ä¹ˆéœ€è¦è‡ªå·± `cd Openaibot` åœ¨é¡¹ç›®ç›®å½•å®‰è£…ä¾èµ–ã€‚

```bash
pip install -r requirements.txt
```

### é…ç½®æ•°æ®åº“

**æœ¬æœº**

```shell
apt-get install redis
systemctl start redis.service
```

é»˜è®¤è®¾ç½®å°±å¯ä»¥å¯åŠ¨äº†ï¼Œå¦‚æœéœ€è¦æŒ‡å®šå‚æ•°ï¼Œä½ å¯ä»¥åœ¨ `Config/service.json` ä¸­é…ç½®å®ƒ

**Docker**

é…ç½® `Config/service.json` ï¼Œéœ€è¦å°† `localhost` æ”¹ä¸º `redis`
å…·ä½“é…ç½®æ–¹æ³•è¯·æŸ¥çœ‹æœåŠ¡é…ç½®ç« èŠ‚ã€‚

### è®¾ç½®ç¨‹åº Config/app.toml

å¤åˆ¶é…ç½®æ¨¡æ¿
`cp app_exp.toml app.toml`

ç¼–è¾‘é…ç½®
`vim app.toml`
`nano app.toml`

**é…ç½®æ–‡ä»¶**

å› ä¸ºæˆ‘ä»¬æ”¯æŒäº†å¤šå¹³å°ï¼Œæ‰€ä»¥å¯ä»¥åŒæ—¶å¯åŠ¨å¤šä¸ªä»£ç†ä¼šè¯ç«¯ã€‚

```toml
# ä¸æƒ³å¯åŠ¨å“ªä¸ªï¼Œå°±æ³¨é‡Šæ‰é‚£ä¸€éƒ¨åˆ†

# QQ æœºå™¨äºº
[Controller.QQ]
master = [114, 514] # master user id , ç®¡ç†è€…è´¦å· ID
account = 0
http_host = 'http://localhost:8080'   # Mirai httpæœåŠ¡å™¨
ws_host = 'http://localhost:8080'   # Mirai WebsocketæœåŠ¡å™¨
verify_key = ""
trigger = false # åˆé€‚çš„æ—¶å€™ä¸»åŠ¨å›å¤
INTRO = "POWER BY OPENAI"  # åç¼€
ABOUT = "Created by github.com/LLMKira/Openaibot" # å…³äºå‘½ä»¤è¿”å›
WHITE = "Group NOT in WHITE list" # é»‘ç™½åå•æç¤º
# è®¾ç½®çš„ä»£ç†ï¼Œä½†æ˜¯ä¸ä»£ç† openai api, åªä»£ç† bot
proxy = { status = false, url = "http://127.0.0.1:7890" }

# Telegram æœºå™¨äºº
[Controller.Telegram]
master = [114, 514] # master user id , ç®¡ç†è€…è´¦å· ID
botToken = '' # æœºå™¨äººå¯†é’¥
trigger = false # åˆé€‚çš„æ—¶å€™ä¸»åŠ¨å›å¤
INTRO = "POWER BY OPENAI"  # åç¼€
ABOUT = "Created by github.com/LLMKira/Openaibot" # å…³äºå‘½ä»¤è¿”å›
WHITE = "Group NOT in WHITE list" # é»‘ç™½åå•æç¤º
# è®¾ç½®çš„ä»£ç†ï¼Œä½†æ˜¯ä¸ä»£ç† openai api, åªä»£ç† bot
proxy = { status = false, url = "http://127.0.0.1:7890" }

# åŸºç¡€å¯¹è¯äº‹ä»¶æœåŠ¡å™¨ï¼ŒWebæ”¯æŒæˆ–è€…éŸ³ç®±ç”¨
[Controller.BaseServer]
port = 9559
```

- é…ç½® Telegram è®¾ç½®

[Telegram botToken ç”³è¯·](https://t.me/BotFather)

ç„¶åå…³é—­éšç§æ¨¡å¼æˆ–è€…ææ‹”æœºå™¨äººä¸ºç®¡ç†å‘˜åæ‰èƒ½ä½¿ç”¨ã€‚

- é…ç½® QQ æœºå™¨äºº

[é…ç½®æœºå™¨äººåç«¯](https://graiax.cn/before/install_mirai.html)

#### å‘½ä»¤æ³¨å†Œ

```shell
chat - äº¤è°ˆ
write - ç»­å†™
forgetme - é‡ç½®è®°å¿†
remind - åœºæ™¯è®¾å®š å–æ¶ˆç”¨çŸ­æ–‡æœ¬è¦†ç›–
voice - è¯­éŸ³æ”¯æŒ
trigger - ç®¡ç†å‘˜å¯åŠ¨ä¸»åŠ¨å›å¤
style - è®¾å®šåå¥½è¯
auto_adjust - è‡ªåŠ¨ä¼˜åŒ–å™¨
set_user_cold - è®¾ç½®ç”¨æˆ·å†·å´æ—¶é—´
set_group_cold - è®¾ç½®ç¾¤ç»„å†·å´æ—¶é—´
set_token_limit - è®¾ç½®è¾“å‡ºé™åˆ¶é•¿åº¦
set_input_limit - è®¾ç½®è¾“å…¥é™åˆ¶é•¿åº¦
see_api_key - ç°åœ¨å‡ ä¸ª Api key
del_api_key - åˆ é™¤ Api key
add_api_key - å¢åŠ  Api key
config - è·å–/å¤‡ä»½çƒ­é…ç½®æ–‡ä»¶
set_per_user_limit - è®¾ç½®æ™®é€šç”¨æˆ·é¢åº¦
set_per_hour_limit - è®¾ç½®ç”¨æˆ·å°æ—¶é¢åº¦
promote_user_limit - æå‡ç”¨æˆ·é¢åº¦
reset_user_usage - é‡ç½®ç”¨æˆ·é¢åº¦
add_block_group - ç¦æ­¢ç¾¤ç»„
del_block_group - è§£ç¦ç¾¤ç»„
add_block_user - ç¦æ­¢ç”¨æˆ·
del_block_user - è§£ç¦ç”¨æˆ·
add_white_group - åŠ å…¥ç™½åå•ç¾¤ç»„
add_white_user - åŠ å…¥ç™½åå•ç”¨æˆ·
del_white_group - é™¤åç™½åå•ç¾¤
del_white_user - é™¤åç™½åå•äºº
update_detect - æ›´æ–°æ•æ„Ÿè¯
open_user_white_mode - å¼€ç”¨æˆ·ç™½åå•
open_group_white_mode - å¼€ç¾¤ç»„ç™½åå•
close_user_white_mode - å…³ç”¨æˆ·ç™½åå•
close_group_white_mode - å…³ç¾¤ç»„ç™½åå•
open - å¼€å¯æœºå™¨äºº
close - å…³é—­æœºå™¨äºº
change_head - è®¾å®šäººè®¾å¼€å…³
change_style - è®¾å®šé£æ ¼å¼€å…³
help - å¸®åŠ©
```

ä¸Šé¢çš„åˆ—è¡¨å¯ä»¥ç›´æ¥åœ¨ Telegram BotFather ä¸­é…ç½®ä¸ºå‘½ä»¤åˆ—è¡¨ã€‚

å…¶ä»–å¹³å°ä¸æ”¯æŒæ³¨å†Œçš„å¹³å°åªè¦è®°ä½å°±å¥½ã€‚

### é…ç½®ç”ŸæˆæœåŠ¡

ä½ æ—¢ç„¶åœ¨ `Config/app.toml` é…ç½®äº† Master ä¸ºä½ ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é…ç½®ç¨‹åºå†…å®¹ã€‚

#### Openai å¯†é’¥

Api Keyå­˜å‚¨åœ¨ `Config/api_keys.json` ä¸‹é¢ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ `/add_api_key` æ·»åŠ å¯†é’¥ã€‚

å¼ºçƒˆå»ºè®®åœ¨æœºå™¨äººç§èŠä¸­é…ç½® key

```markdown
see_api_key - ç°åœ¨å‡ ä¸ª Api key
del_api_key - åˆ é™¤ Api key
add_api_key - å¢åŠ  Api key
```

```json
{
  "OPENAI_API_KEY": [
    "sk-***********",
    "sk-***********"
  ]
}
```

[OPENAI_API_KEY ç”³è¯·](https://beta.openai.com/account/api-keys)ï¼Œæ”¯æŒå¤š key åˆ†å‘è´Ÿè½½ã€‚
[å®šä»·å‚è€ƒ](https://openai.com/api/pricing/)ã€‚

### é…ç½®åŸºç¡€æƒé™

é»˜è®¤æƒ…å†µä¸‹ï¼Œç¨‹åºæ˜¯ä¸å…è®¸ä»»ä½•äººå¯¹è¯çš„ï¼Œå¤„äºç™½åå•æ¨¡å¼ã€‚

èŠå¤©å’Œåå•ç›¸å…³é…ç½®åœ¨ `Config/config.json` ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `/config` æ¥æŸ¥çœ‹/å¤‡ä»½æ­¤æ–‡ä»¶ã€‚

```shell
# ç›¸å…³å‘½ä»¤
add_block_group - ç¦æ­¢ç¾¤ç»„
del_block_group - è§£ç¦ç¾¤ç»„
add_block_user - ç¦æ­¢ç”¨æˆ·
del_block_user - è§£ç¦ç”¨æˆ·
add_white_group - åŠ å…¥ç™½åå•ç¾¤ç»„
add_white_user - åŠ å…¥ç™½åå•ç”¨æˆ·
del_white_group - é™¤åç™½åå•ç¾¤
del_white_user - é™¤åç™½åå•äºº
open_user_white_mode - å¼€ç”¨æˆ·ç™½åå•
open_group_white_mode - å¼€ç¾¤ç»„ç™½åå•
close_user_white_mode - å…³ç”¨æˆ·ç™½åå•
close_group_white_mode - å…³ç¾¤ç»„ç™½åå•
```

ä¸ºäº†é˜²æ­¢ä¸åŒå¹³å°åŒIDçš„æƒ…å†µï¼Œåœ¨å‘½ä»¤ä¸­ä»»ä½• ID åé¢éƒ½åº”è¯¥åŠ  ç›¸åº”å¹³å°çš„åç¼€ã€‚å…·ä½“ä½¿ç”¨è¿˜è¯·æŸ¥çœ‹ `ä½¿ç”¨` ä¸€èŠ‚ã€‚

#### Controller å¹³å°åç¼€

| Controller | suffix_id | desc |
|------------|-----------|------|
| QQ         | 101       |      |
| Telegram   | 100       |      |
| Api        | 103       |      |

